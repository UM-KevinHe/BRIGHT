Tind="GWAS"
Tss <- read.table("~/Desktop/research/Kevin He/PRS/Rewrite_Lassosum/example_2/SAS1_train.GWAS",header = T)
head(Tss)
Pind=c("GWAS")
Pss <- read.table("~/Desktop/research/Kevin He/PRS/Rewrite_Lassosum/example_2/EUR.GWAS",header = T)
head(Pss)
setwd("~/Desktop/research/Kevin He/PRS/Rewrite_Lassosum/new_BRIGHT/BRIGHT/")
library(devtools)
library(pkgdown)
load_all()
Tind="GWAS"
Tss <- read.table("~/Desktop/research/Kevin He/PRS/Rewrite_Lassosum/example_2/SAS1_train.GWAS",header = T)
head(Tss)
Pind=c("GWAS")
Pss <- read.table("~/Desktop/research/Kevin He/PRS/Rewrite_Lassosum/example_2/EUR.GWAS",header = T)
head(Pss)
Tref <- "~/Desktop/research/Kevin He/PRS/Rewrite_Lassosum/example_2/SAS1_train"
Pref <- "~/Desktop/research/Kevin He/PRS/Rewrite_Lassosum/example_2/EUR"
dat=PreprocessS(Tss, Tind, Tref, Pss, Pind, Pref, TLDblocks=c("AFR"), PLDblocks=c("EUR"),TN=100,PN=11514)
setwd("~/Desktop/research/Kevin He/PRS/Rewrite_Lassosum/new_BRIGHT/BRIGHT/")
library(devtools)
library(pkgdown)
load_all()
Tind="GWAS"
Tss <- read.table("~/Desktop/research/Kevin He/PRS/Rewrite_Lassosum/example_2/SAS1_train.GWAS",header = T)
head(Tss)
Pind=c("GWAS")
Pss <- read.table("~/Desktop/research/Kevin He/PRS/Rewrite_Lassosum/example_2/EUR.GWAS",header = T)
head(Pss)
Tref <- "~/Desktop/research/Kevin He/PRS/Rewrite_Lassosum/example_2/SAS1_train"
Pref <- "~/Desktop/research/Kevin He/PRS/Rewrite_Lassosum/example_2/EUR"
dat=PreprocessS(Tss, Tind, Tref, Pss, Pind, Pref, TLDblocks=c("AFR"), PLDblocks=c("EUR"),TN=100,PN=11514)
eta_vec=c(0,exp(seq(log(0.1),log(10),length.out=20)))
out <- BRIGHTs(data = dat, eta = eta_vec)
out <- BRIGHTs(data = dat, eta = eta_vec,penalty = 2)
out <- BRIGHTs(data = dat, eta = eta_vec,penalty = 3)
out <- BRIGHTs(data = dat, eta = eta_vec,penalty = 1,alpha = 0.5)
out <- BRIGHTs(data = dat, eta = eta_vec,penalty = 1,group = c(0,0,0,1:97))
out$`0`$Beta[1:5,]
setwd("~/Desktop/research/Kevin He/PRS/Rewrite_Lassosum/example_2/")
p2cor <- function(p, n, sign=rep(1, length(p))) {
stopifnot(length(n)==1 || length(n) == length(p))
stopifnot(length(p) == length(sign))
t <- sign(sign) * qt(p/2, df=n-2, lower.tail=F)
return(t / sqrt(n - 2 + t^2))
}
for(i in c("SAS1_train","SAS2","EUR")){
GWAS=read.table(paste(i,".qassoc",sep=""),header=T)
bim=read.table(paste(i,".bim",sep=""),header=F)
print(sum(bim[,2]==GWAS[,2]))
GWAS_rst=data.frame(bim[,1],bim[,4],bim[,5],bim[,6],sign(GWAS[,5]),GWAS[,4],GWAS[,9])
colnames(GWAS_rst)=c("CHR","BP","A1","A2","Sign","N","P")
IProd_rst=data.frame(bim[,1],bim[,4],bim[,5],bim[,6],p2cor(GWAS[,9],GWAS[,4],sign(GWAS[,5])))
colnames(IProd_rst)=c("CHR","BP","A1","A2","Corr")
write.table(GWAS_rst,file=paste(i,".GWAS",sep=""),col.names = T,row.names = F,quote = F)
write.table(IProd_rst,file=paste(i,".Corr",sep=""),col.names = T,row.names = F,quote = F)
}
setwd("~/Desktop/research/Kevin He/PRS/Rewrite_Lassosum/new_BRIGHT/BRIGHT/")
library(devtools)
library(pkgdown)
load_all()
Tind="GWAS"
Tss <- read.table("~/Desktop/research/Kevin He/PRS/Rewrite_Lassosum/example_2/SAS1_train.GWAS",header = T)
head(Tss)
Pind=c("GWAS")
Pss <- read.table("~/Desktop/research/Kevin He/PRS/Rewrite_Lassosum/example_2/EUR.GWAS",header = T)
head(Pss)
Tref <- "~/Desktop/research/Kevin He/PRS/Rewrite_Lassosum/example_2/SAS1_train"
Pref <- "~/Desktop/research/Kevin He/PRS/Rewrite_Lassosum/example_2/EUR"
dat=PreprocessS(Tss, Tind, Tref, Pss, Pind, Pref, TLDblocks=c("AFR"), PLDblocks=c("EUR"),TN=100,PN=11514)
eta_vec=c(0,exp(seq(log(0.1),log(10),length.out=20)))
out <- BRIGHTs(data = dat, eta = eta_vec)
Eta_curve.plot(out,valid.type = "AIC")
Valipheno=read.table("~/Desktop/research/Kevin He/PRS/Rewrite_Lassosum/example_2/SAS2_phe.fam")
Valigeno="~/Desktop/research/Kevin He/PRS/Rewrite_Lassosum/example_2/SAS2"
Val=Valid.Ind(out,Valipheno,Valigeno)
Eta_curve.plot(Val,valid.type = "Ind")
Solution.path(Val,out,highlight=c(25,50,70,92),criteria="PD")
ValiCorr=read.table("~/Desktop/research/Kevin He/PRS/Rewrite_Lassosum/example_2/SAS2.Corr",header = T)
ValiRef="~/Desktop/research/Kevin He/PRS/Rewrite_Lassosum/example_2/SAS1_LD"
Val.Sum <- Valid.Sum(out, ValiCorr, ValiRef)
load_all()
ValiCorr=read.table("~/Desktop/research/Kevin He/PRS/Rewrite_Lassosum/example_2/SAS2.Corr",header = T)
ValiRef="~/Desktop/research/Kevin He/PRS/Rewrite_Lassosum/example_2/SAS1_LD"
Val.Sum <- Valid.Sum(out, ValiCorr, ValiRef)
Eta_curve.plot(Val.Sum,valid.type = "Sum")
Solution.path(Val.Sum,out,highlight=c(25,50,70,92),criteria="APD")
Testpheno=read.table("~/Desktop/research/Kevin He/PRS/Rewrite_Lassosum/example_2/SAS2_phe_test.fam")
Testgeno="~/Desktop/research/Kevin He/PRS/Rewrite_Lassosum/example_2/SAS2"
Tst <- Test.Ind(Val, Testpheno, Testgeno)
Density.plot(Tst,Pct=0.9,criteria = "R2")
ROC.plot(Tst,Pct=0.9,criteria = "R2")
setwd("~/Desktop/research/Kevin He/PRS/Rewrite_Lassosum/new_BRIGHT/BRIGHT/")
library(devtools)
library(pkgdown)
load_all()
Tind="GWAS"
Tss <- read.table("~/Desktop/research/Kevin He/PRS/Rewrite_Lassosum/example_2/SAS1_train.GWAS",header = T)
head(Tss)
Pind=c("GWAS")
Pss <- read.table("~/Desktop/research/Kevin He/PRS/Rewrite_Lassosum/example_2/EUR.GWAS",header = T)
head(Pss)
Tref <- "~/Desktop/research/Kevin He/PRS/Rewrite_Lassosum/example_2/SAS1_train"
Pref <- "~/Desktop/research/Kevin He/PRS/Rewrite_Lassosum/example_2/EUR"
dat=PreprocessS(Tss, Tind, Tref, Pss, Pind, Pref, TLDblocks=c("AFR"), PLDblocks=c("EUR"),TN=100,PN=11514)
setwd("~/Desktop/research/Kevin He/PRS/Rewrite_Lassosum/new_BRIGHT/BRIGHT/")
library(devtools)
library(pkgdown)
load_all()
Tind="GWAS"
Tss <- read.table("~/Desktop/research/Kevin He/PRS/Rewrite_Lassosum/example_2/SAS1_train.GWAS",header = T)
head(Tss)
Pind=c("GWAS")
Pss <- read.table("~/Desktop/research/Kevin He/PRS/Rewrite_Lassosum/example_2/EUR.GWAS",header = T)
head(Pss)
Tref <- "~/Desktop/research/Kevin He/PRS/Rewrite_Lassosum/example_2/SAS1_train"
Pref <- "~/Desktop/research/Kevin He/PRS/Rewrite_Lassosum/example_2/EUR"
dat=PreprocessS(Tss, Tind, Tref, Pss, Pind, Pref, TLDblocks=c("AFR"), PLDblocks=c("EUR"),TN=100,PN=11514)
setwd("~/Desktop/research/Kevin He/PRS/Rewrite_Lassosum/new_BRIGHT/BRIGHT/")
library(devtools)
library(pkgdown)
load_all()
Tind="GWAS"
Tss <- read.table("~/Desktop/research/Kevin He/PRS/Rewrite_Lassosum/example_2/SAS1_train.GWAS",header = T)
head(Tss)
Pind=c("GWAS")
Pss <- read.table("~/Desktop/research/Kevin He/PRS/Rewrite_Lassosum/example_2/EUR.GWAS",header = T)
head(Pss)
Tref <- "~/Desktop/research/Kevin He/PRS/Rewrite_Lassosum/example_2/SAS1_train"
Pref <- "~/Desktop/research/Kevin He/PRS/Rewrite_Lassosum/example_2/EUR"
dat=PreprocessS(Tss, Tind, Tref, Pss, Pind, Pref, TLDblocks=c("AFR"), PLDblocks=c("EUR"),TN=100,PN=11514)
setwd("~/Desktop/research/Kevin He/PRS/Rewrite_Lassosum/new_BRIGHT/BRIGHT/")
library(devtools)
library(pkgdown)
load_all()
Tind="GWAS"
Tss <- read.table("~/Desktop/research/Kevin He/PRS/Rewrite_Lassosum/example_2/SAS1_train.GWAS",header = T)
head(Tss)
Pind=c("GWAS")
Pss <- read.table("~/Desktop/research/Kevin He/PRS/Rewrite_Lassosum/example_2/EUR.GWAS",header = T)
head(Pss)
Tref <- "~/Desktop/research/Kevin He/PRS/Rewrite_Lassosum/example_2/SAS1_train"
Pref <- "~/Desktop/research/Kevin He/PRS/Rewrite_Lassosum/example_2/EUR"
dat=PreprocessS(Tss, Tind, Tref, Pss, Pind, Pref, TLDblocks=c("AFR"), PLDblocks=c("EUR"),TN=100,PN=11514)
eta_vec=c(0,exp(seq(log(0.1),log(10),length.out=20)))
out <- BRIGHTs(data = dat, eta = eta_vec)
setwd("~/Desktop/research/Kevin He/PRS/Rewrite_Lassosum/new_BRIGHT/BRIGHT/")
library(devtools)
library(pkgdown)
load_all()
Tind="GWAS"
Tss <- read.table("~/Desktop/research/Kevin He/PRS/Rewrite_Lassosum/example_2/SAS1_train.GWAS",header = T)
head(Tss)
Pind=c("GWAS")
Pss <- read.table("~/Desktop/research/Kevin He/PRS/Rewrite_Lassosum/example_2/EUR.GWAS",header = T)
head(Pss)
Tref <- "~/Desktop/research/Kevin He/PRS/Rewrite_Lassosum/example_2/SAS1_train"
Pref <- "~/Desktop/research/Kevin He/PRS/Rewrite_Lassosum/example_2/EUR"
dat=PreprocessS(Tss, Tind, Tref, Pss, Pind, Pref, TLDblocks=c("AFR"), PLDblocks=c("EUR"),TN=100,PN=11514)
dat
save(dat,"ToyExample.rda")
save(dat,file="ToyExample.rda")
setwd("~/Desktop/research/Kevin He/PRS/Rewrite_Lassosum/new_BRIGHT/BRIGHT/")
library(devtools)
library(pkgdown)
load_all()
data("ToyExample")
setwd("~/Desktop/research/Kevin He/PRS/Rewrite_Lassosum/new_BRIGHT/BRIGHT/")
library(devtools)
library(pkgdown)
load_all()
data("ToyExample")
setwd("~/Desktop/research/Kevin He/PRS/Rewrite_Lassosum/new_BRIGHT/BRIGHT/")
library(devtools)
library(pkgdown)
load_all()
Tind="GWAS"
Tss <- read.table("~/Desktop/research/Kevin He/PRS/Rewrite_Lassosum/example_2/SAS1_train.GWAS",header = T)
head(Tss)
Pind=c("GWAS")
Pss <- read.table("~/Desktop/research/Kevin He/PRS/Rewrite_Lassosum/example_2/EUR.GWAS",header = T)
head(Pss)
Tref <- "~/Desktop/research/Kevin He/PRS/Rewrite_Lassosum/example_2/SAS1_train"
Pref <- "~/Desktop/research/Kevin He/PRS/Rewrite_Lassosum/example_2/EUR"
dat=PreprocessS(Tss, Tind, Tref, Pss, Pind, Pref, TLDblocks=c("AFR"), PLDblocks=c("EUR"),TN=100,PN=11514)
#eta_vec=c(0,exp(seq(log(0.1),log(10),length.out=20)))
out <- BRIGHTs(data = dat, eta = eta_vec)
#eta_vec=c(0,exp(seq(log(0.1),log(10),length.out=20)))
out <- BRIGHTs(data = dat)
setwd("~/Desktop/research/Kevin He/PRS/Rewrite_Lassosum/new_BRIGHT/BRIGHT/")
library(devtools)
library(pkgdown)
load_all()
Tind <- "GWAS"
Tss <- read.table("~/Desktop/research/Kevin He/PRS/Rewrite_Lassosum/example_2/SAS1_train.GWAS",header = T)
head(Tss)
# Read in target GWAS
Tind="Corr"
Tss <- read.table("~/Desktop/research/Kevin He/PRS/Rewrite_Lassosum/example_2/SAS1_train.Corr",header = T)
head(Tss)
head(dat$Pss)
head(dat$Pss[,-1])
write.table(dat$Pss[,-1],file = "EUR.Coef",quote=F,col.names = T,row.names = F)
library(devtools)
library(pkgdown)
build_site()
build_site()
library(BRIGHT)
data(ToyExample)
out <- BRIGHTs(data = dat)
dat$Tref
#eta_vec=c(0,exp(seq(log(0.1),log(10),length.out=20)))
out <- BRIGHTs(data = dat)
getwd()
setwd("../")
out <- BRIGHTs(data = dat)
library(BRIGHT)
setwd("~/Desktop/research/Kevin He/PRS/Rewrite_Lassosum/new_BRIGHT/BRIGHT/")
library(devtools)
library(pkgdown)
load_all()
library(BRIGHT)
data(ToyExample)
out <- BRIGHTs(data = dat)
library(BEDMatrix)
out <- BRIGHTs(data = dat)
setwd("~/Desktop/research/Kevin He/PRS/Rewrite_Lassosum/new_BRIGHT/BRIGHT/")
library(devtools)
library(pkgdown)
load_all()
EUR.hg19=read.table(paste("inst/data/Berisa.EUR.hg19.bed",sep=""),header=T)
AFR.hg19=read.table(paste("inst/data/Berisa.AFR.hg19.bed",sep=""),header=T)
ASN.hg19=read.table(paste("inst/data/Berisa.ASN.hg19.bed",sep=""),header=T)
ASN.hg38=read.table(paste("inst/data/Berisa.ASN.hg38.bed",sep=""),header=T)
AFR.hg38=read.table(paste("inst/data/Berisa.AFR.hg38.bed",sep=""),header=T)
EUR.hg38=read.table(paste("inst/data/Berisa.EUR.hg38.bed",sep=""),header=T)
getwd()
save(EUR.hg19,AFR.hg19,ASN.hg19,ASN.hg38,AFR.hg38,EUR.hg38,file="Berisa.LD.rda")
setwd("~/Desktop/research/Kevin He/PRS/Rewrite_Lassosum/new_BRIGHT/BRIGHT/")
library(devtools)
library(pkgdown)
load_all()
data("Berisa.LD")
usethis::use_data("data/Berisa.LD.rda")
setwd("~/Desktop/research/Kevin He/PRS/Rewrite_Lassosum/new_BRIGHT/BRIGHT/")
library(devtools)
library(pkgdown)
load_all()
Tind <- "GWAS"
Tss <- read.table("~/Desktop/research/Kevin He/PRS/Rewrite_Lassosum/example_2/SAS1_train.GWAS",header = T)
head(Tss)
Pind <- c("GWAS")
Pss <- read.table("~/Desktop/research/Kevin He/PRS/Rewrite_Lassosum/example_2/EUR.GWAS",header = T)
head(Pss)
Tref <- "~/Desktop/research/Kevin He/PRS/Rewrite_Lassosum/example_2/SAS1_train"
Pref <- "~/Desktop/research/Kevin He/PRS/Rewrite_Lassosum/example_2/EUR"
dat=PreprocessS(Tss, Tind, Tref, Pss, Pind, Pref, TLDblocks=c("AFR.hg19"), PLDblocks=c("EUR.hg19"),TN=100,PN=11514)
library(BEDMatrix)
dat=PreprocessS(Tss, Tind, Tref, Pss, Pind, Pref, TLDblocks=c("AFR.hg19"), PLDblocks=c("EUR.hg19"),TN=100,PN=11514)
#eta_vec=c(0,exp(seq(log(0.1),log(10),length.out=20)))
out <- BRIGHTs(data = dat)
setwd("~")
#eta_vec=c(0,exp(seq(log(0.1),log(10),length.out=20)))
out <- BRIGHTs(data = dat)
head(EUR.hg19)
data("Berisa.LD")
setwd("~/Desktop/research/Kevin He/PRS/Rewrite_Lassosum/new_BRIGHT/BRIGHT/")
library(devtools)
library(pkgdown)
load_all()
Tind <- "GWAS"
Tss <- read.table("~/Desktop/research/Kevin He/PRS/Rewrite_Lassosum/example_2/SAS1_train.GWAS",header = T)
head(Tss)
Pind <- c("GWAS")
Pss <- read.table("~/Desktop/research/Kevin He/PRS/Rewrite_Lassosum/example_2/EUR.GWAS",header = T)
head(Pss)
Tref <- "~/Desktop/research/Kevin He/PRS/Rewrite_Lassosum/example_2/SAS1_train"
Pref <- "~/Desktop/research/Kevin He/PRS/Rewrite_Lassosum/example_2/EUR"
dat=PreprocessS(Tss, Tind, Tref, Pss, Pind, Pref, TLDblocks=c("AFR.hg19"), PLDblocks=c("EUR.hg19"),TN=100,PN=11514)
#eta_vec=c(0,exp(seq(log(0.1),log(10),length.out=20)))
out <- BRIGHTs(data = dat)
library(BRIGHT)
data(ToyExample)
out <- BRIGHTs(data = dat)
setwd("~/Desktop/research/Kevin He/PRS/Rewrite_Lassosum/new_BRIGHT/BRIGHT/")
library(devtools)
library(pkgdown)
load_all()
Tind <- "GWAS"
Tss <- read.table("~/Desktop/research/Kevin He/PRS/Rewrite_Lassosum/example_2/SAS1_train.GWAS",header = T)
head(Tss)
Pind <- c("GWAS")
Pss <- read.table("~/Desktop/research/Kevin He/PRS/Rewrite_Lassosum/example_2/EUR.GWAS",header = T)
head(Pss)
Tref <- "~/Desktop/research/Kevin He/PRS/Rewrite_Lassosum/example_2/SAS1_train"
Pref <- "~/Desktop/research/Kevin He/PRS/Rewrite_Lassosum/example_2/EUR"
dat=PreprocessS(Tss, Tind, Tref, Pss, Pind, Pref, TLDblocks=c("AFR.hg19"), PLDblocks=c("EUR.hg19"),TN=100,PN=11514)
save(dat, file="ToyExample.rda")
library(BRIGHT)
data(ToyExample)
out <- BRIGHTs(data = dat)
build_site()
build_site()
build_site()
build_site()
build_site()
setwd("~/Desktop/research/Kevin He/PRS/Rewrite_Lassosum/new_BRIGHT/BRIGHT/")
library(devtools)
library(pkgdown)
load_all()
Tind <- "GWAS"
Tss <- read.table("~/Desktop/research/Kevin He/PRS/Rewrite_Lassosum/example_2/SAS1_train.GWAS",header = T)
head(Tss)
Pind <- c("GWAS")
Pss <- read.table("~/Desktop/research/Kevin He/PRS/Rewrite_Lassosum/example_2/EUR.GWAS",header = T)
head(Pss)
Tref <- "~/Desktop/research/Kevin He/PRS/Rewrite_Lassosum/example_2/SAS1_train"
Pref <- "~/Desktop/research/Kevin He/PRS/Rewrite_Lassosum/example_2/EUR"
dat=PreprocessS(Tss, Tind, Tref, Pss, Pind, Pref, TLDblocks=c("AFR.hg19"), PLDblocks=c("EUR.hg19"),TN=100,PN=11514)
#eta_vec=c(0,exp(seq(log(0.1),log(10),length.out=20)))
out <- BRIGHTs(data = dat)
Eta_curve.plot(out,valid.type = "AIC")
build_site()
install.packages("pkgdown")
install.packages("pkgdown")
library(pkgdown)
build_site()
library(BRIGHT)
load_all()
setwd("~/Desktop/research/Kevin He/PRS/Rewrite_Lassosum/new_BRIGHT/BRIGHT/")
library(devtools)
library(pkgdown)
load_all()
library(BRIGHT)
BEDMatrix()
setwd("~/Desktop/research/Kevin He/PRS/Rewrite_Lassosum/new_BRIGHT/BRIGHT/")
library(devtools)
library(pkgdown)
load_all()
Tind <- "GWAS"
Tss <- read.table("~/Desktop/research/Kevin He/PRS/Rewrite_Lassosum/example_2/SAS1_train.GWAS",header = T)
head(Tss)
Pind <- c("GWAS")
Pss <- read.table("~/Desktop/research/Kevin He/PRS/Rewrite_Lassosum/example_2/EUR.GWAS",header = T)
head(Pss)
Tref <- "~/Desktop/research/Kevin He/PRS/Rewrite_Lassosum/example_2/SAS1_train"
Pref <- "~/Desktop/research/Kevin He/PRS/Rewrite_Lassosum/example_2/EUR"
dat=PreprocessS(Tss, Tind, Tref, Pss, Pind, Pref, TLDblocks=c("AFR.hg19"), PLDblocks=c("EUR.hg19"),TN=100,PN=11514)
packageVersion("BEDMatrix")
setwd("~/Desktop/research/Kevin He/PRS/Rewrite_Lassosum/new_BRIGHT/BRIGHT/")
library(devtools)
library(pkgdown)
load_all()
setwd("~/Desktop/research/Kevin He/PRS/Rewrite_Lassosum/new_BRIGHT/BRIGHT/")
library(devtools)
library(pkgdown)
load_all()
Tind <- "GWAS"
Tss <- read.table("~/Desktop/research/Kevin He/PRS/Rewrite_Lassosum/example_2/SAS1_train.GWAS",header = T)
head(Tss)
Pind <- c("GWAS")
Pss <- read.table("~/Desktop/research/Kevin He/PRS/Rewrite_Lassosum/example_2/EUR.GWAS",header = T)
head(Pss)
Tref <- "~/Desktop/research/Kevin He/PRS/Rewrite_Lassosum/example_2/SAS1_train"
Pref <- "~/Desktop/research/Kevin He/PRS/Rewrite_Lassosum/example_2/EUR"
dat=PreprocessS(Tss, Tind, Tref, Pss, Pind, Pref, TLDblocks=c("AFR.hg19"), PLDblocks=c("EUR.hg19"),TN=100,PN=11514)
setwd("~/Desktop/research/Kevin He/PRS/Rewrite_Lassosum/new_BRIGHT/BRIGHT/")
library(devtools)
library(pkgdown)
load_all()
Tind <- "GWAS"
Tss <- read.table("~/Desktop/research/Kevin He/PRS/Rewrite_Lassosum/example_2/SAS1_train.GWAS",header = T)
head(Tss)
Pind <- c("GWAS")
Pss <- read.table("~/Desktop/research/Kevin He/PRS/Rewrite_Lassosum/example_2/EUR.GWAS",header = T)
head(Pss)
Tref <- "~/Desktop/research/Kevin He/PRS/Rewrite_Lassosum/example_2/SAS1_train"
Pref <- "~/Desktop/research/Kevin He/PRS/Rewrite_Lassosum/example_2/EUR"
dat=PreprocessS(Tss, Tind, Tref, Pss, Pind, Pref, TLDblocks=c("AFR.hg19"), PLDblocks=c("EUR.hg19"),TN=100,PN=11514)
#eta_vec=c(0,exp(seq(log(0.1),log(10),length.out=20)))
out <- BRIGHTs(data = dat)
build_site()
build_site()
setwd("~/Desktop/research/Kevin He/PRS/Rewrite_Lassosum/new_BRIGHT/BRIGHT/")
library(devtools)
library(pkgdown)
load_all()
Tind <- "GWAS"
Tss <- read.table("~/Desktop/research/Kevin He/PRS/Rewrite_Lassosum/example_2/SAS1_train.GWAS",header = T)
head(Tss)
Pind <- c("GWAS")
Pss <- read.table("~/Desktop/research/Kevin He/PRS/Rewrite_Lassosum/example_2/EUR.GWAS",header = T)
head(Pss)
Tref <- "~/Desktop/research/Kevin He/PRS/Rewrite_Lassosum/example_2/SAS1_train"
Pref <- "~/Desktop/research/Kevin He/PRS/Rewrite_Lassosum/example_2/EUR"
dat=PreprocessS(Tss, Tind, Tref, Pss, Pind, Pref, TLDblocks=c("SAS.hg19"), PLDblocks=c("EUR.hg19"),TN=100,PN=11514)
#eta_vec=c(0,exp(seq(log(0.1),log(10),length.out=20)))
out <- BRIGHTs(data = dat)
dat=PreprocessS(Tss, Tind, Tref, Pss, Pind, Pref, TLDblocks=c("AFR.hg19"), PLDblocks=c("EUR.hg19"),TN=100,PN=11514)
#eta_vec=c(0,exp(seq(log(0.1),log(10),length.out=20)))
out <- BRIGHTs(data = dat)
dat=PreprocessS(Tss, Tind, Tref, Pss, Pind, Pref, TLDblocks=c("SAS.hg19"), PLDblocks=c("EUR.hg19"),TN=100,PN=11514)
#eta_vec=c(0,exp(seq(log(0.1),log(10),length.out=20)))
out <- BRIGHTs(data = dat)
Eta_curve.plot(out,valid.type = "AIC")
Valipheno=read.table("~/Desktop/research/Kevin He/PRS/Rewrite_Lassosum/example_2/SAS2_phe.fam")
Valigeno="~/Desktop/research/Kevin He/PRS/Rewrite_Lassosum/example_2/SAS2"
Val=Valid.Ind(out,Valipheno,Valigeno)
Eta_curve.plot(Val,valid.type = "Ind")
Solution.path(Val,out,highlight=c(25,50,70,92),criteria="PD")
ValiCorr=read.table("~/Desktop/research/Kevin He/PRS/Rewrite_Lassosum/example_2/SAS2.Corr",header = T)
ValiRef="~/Desktop/research/Kevin He/PRS/Rewrite_Lassosum/example_2/SAS1_LD"
Val.Sum <- Valid.Sum(out, ValiCorr, ValiRef)
Eta_curve.plot(Val.Sum,valid.type = "Sum")
Solution.path(Val.Sum,out,highlight=c(25,50,70,92),criteria="APD")
Testpheno=read.table("~/Desktop/research/Kevin He/PRS/Rewrite_Lassosum/example_2/SAS2_phe_test.fam")
Testgeno="~/Desktop/research/Kevin He/PRS/Rewrite_Lassosum/example_2/SAS2"
Tst <- Test.Ind(Val, Testpheno, Testgeno)
Density.plot(Tst,Pct=0.9,criteria = "R2")
ROC.plot(Tst,Pct=0.9,criteria = "R2")
build_site()
setwd("~/Desktop/research/Kevin He/PRS/Rewrite_Lassosum/new_BRIGHT/BRIGHT/")
library(devtools)
library(pkgdown)
load_all()
Tind <- "GWAS"
Tss <- read.table("~/Desktop/research/Kevin He/PRS/Rewrite_Lassosum/example_2/SAS1_train.GWAS",header = T)
head(Tss)
Pind <- c("GWAS")
Pss <- read.table("~/Desktop/research/Kevin He/PRS/Rewrite_Lassosum/example_2/EUR.GWAS",header = T)
head(Pss)
Tref <- "~/Desktop/research/Kevin He/PRS/Rewrite_Lassosum/example_2/SAS1_train"
Pref <- "~/Desktop/research/Kevin He/PRS/Rewrite_Lassosum/example_2/EUR"
dat=PreprocessS(Tss, Tind, Tref, Pss, Pind, Pref, TLDblocks=c("ASN.hg19"), PLDblocks=c("EUR.hg19"),TN=100,PN=11514)
#eta_vec=c(0,exp(seq(log(0.1),log(10),length.out=20)))
out <- BRIGHTs(data = dat)
Eta_curve.plot(out,valid.type = "AIC")
Valipheno=read.table("~/Desktop/research/Kevin He/PRS/Rewrite_Lassosum/example_2/SAS2_phe.fam")
Valigeno="~/Desktop/research/Kevin He/PRS/Rewrite_Lassosum/example_2/SAS2"
Val=Valid.Ind(out,Valipheno,Valigeno)
setwd("~/Desktop/research/Kevin He/PRS/Rewrite_Lassosum/new_BRIGHT/BRIGHT/")
library(devtools)
library(pkgdown)
load_all()
Tind <- "GWAS"
Tss <- read.table("~/Desktop/research/Kevin He/PRS/Rewrite_Lassosum/example_2/SAS1_train.GWAS",header = T)
head(Tss)
Pind <- c("GWAS")
Pss <- read.table("~/Desktop/research/Kevin He/PRS/Rewrite_Lassosum/example_2/EUR.GWAS",header = T)
head(Pss)
Tref <- "~/Desktop/research/Kevin He/PRS/Rewrite_Lassosum/example_2/SAS1_train"
Pref <- "~/Desktop/research/Kevin He/PRS/Rewrite_Lassosum/example_2/EUR"
dat=PreprocessS(Tss, Tind, Tref, Pss, Pind, Pref, TLDblocks=c("EAS.hg19"), PLDblocks=c("EUR.hg19"),TN=100,PN=11514)
#eta_vec=c(0,exp(seq(log(0.1),log(10),length.out=20)))
out <- BRIGHTs(data = dat)
Eta_curve.plot(out,valid.type = "AIC")
build_site()
library(BRIGHT)
data(ToyExample)
out <- BRIGHTs(data = dat)
# Plot AIC
Eta_curve.plot(out,valid.type = "AIC")
# Read in target GWAS
TN <- 100
Tind <- "GWAS"
Tss <- read.table("~/Desktop/research/Kevin He/PRS/Rewrite_Lassosum/example_2/SAS1_train.GWAS",header = T)
head(Tss)
# Read in target GWAS
TN <- 100
Tind <- "Corr"
Tss <- read.table("~/Desktop/research/Kevin He/PRS/Rewrite_Lassosum/example_2/SAS1_train.Corr",header = T)
head(Tss)
### Read prior majority GWAS summary statistics file more than 1 prior majority data can be read in###
PN <- 11514
Pind <- c("GWAS")
Pss <- read.table("~/Desktop/research/Kevin He/PRS/Rewrite_Lassosum/example_2/EUR.GWAS",header = T)
head(Pss)
### Read prior majority marginal genotype-trait inner product more than 1 prior majority data can be read in###
PN <- 11514
Pind <- c("Corr")
Pss <- read.table("~/Desktop/research/Kevin He/PRS/Rewrite_Lassosum/example/EUR.Corr",header = T)
head(Pss)
Pind <- c("Coef")
Pss <- read.table("~/Desktop/research/Kevin He/PRS/Rewrite_Lassosum/example_2/EUR.Coef",header = T)
head(Pss)
Pind <- c("Coef")
Pss <- read.table("~/Desktop/research/Kevin He/PRS/Rewrite_Lassosum/example_2/EUR.Coef",header = T)
head(Pss)
### Specify the PLINK file stub of the reference panel or "EUR", "AFR", "EAS", "SAS" ,or "AMR" ###
Tref <- "~/Desktop/research/Kevin He/PRS/Rewrite_Lassosum/example_2/SAS1_train"
Pref <- "~/Desktop/research/Kevin He/PRS/Rewrite_Lassosum/example_2/EUR" #Pref is only required if the Pind is "GWAS" or "Corr"
### Read LD region file, only required if ref.bfile is provided as PLINK1 format ###
TLDblocks <- "SAS.hg19" # This will use LD regions as defined in Berisa and Pickrell (2015) for the South Asian population and the hg19 genome build.
PLDblocks <- "EUR.hg19" # This will use LD regions as defined in Berisa and Pickrell (2015) for the European population and the hg19 genome build. PLDblocks is only required if the Pind is "GWAS" or "Corr".
TN <- 100
Tind <- "GWAS"
Tss <- read.table("~/Desktop/research/Kevin He/PRS/Rewrite_Lassosum/example_2/SAS1_train.GWAS",header = T)
PN <- 11514
Pind <- c("Corr")
Pss <- read.table("~/Desktop/research/Kevin He/PRS/Rewrite_Lassosum/example/EUR.Corr",header = T)
build_site()
build_site()
build_site()
build_site()
build_site()
build_site()
build_site()
build_site()
build_site()
build_site()
build_site()
build_site()
