k1=0.01
k2=0.02
c1=1
c2=1.5
d1=1
d2=1
eta=(2500:10000)/50
c1/k1/d1
c2/k2/d2
k1=0.01
k2=0.005
c1=1
c2=1.5
d1=1
d2=1
eta=(2500:10000)/50
c1/k1/d1
c2/k2/d2
k1=0.01
k2=0.005
c1=1
c2=1.5
d1=1
d2=1
eta=(2500:10000)/50
c1/k1/d1
c2/k2/d2
k1=0.01
k2=0.005
c1=1
c2=1.5
d1=1
d2=1
eta=(2500:10000)/50
c1/k1/d1
c2/k2/d2
(d1+2*c1)/k1/d1
(d2+2*c2)/k2/d2
k1=0.01
k2=0.01
c1=1
c2=2
d1=1
d2=1
eta=(2500:10000)/50
c1/k1/d1
c2/k2/d2
(d1+2*c1)/k1/d1
(d2+2*c2)/k2/d2
k1=0.01
k2=0.01
c1=1
c2=4
d1=1
d2=1
eta=(2500:10000)/50
c1/k1/d1
c2/k2/d2
(d1+2*c1)/k1/d1
(d2+2*c2)/k2/d2
k1=0.01
k2=0.01
c1=1
c2=4
d1=1
d2=1
eta=(500:10000)/10
c1/k1/d1
c2/k2/d2
(d1+2*c1)/k1/d1
(d2+2*c2)/k2/d2
y=(c1+d1*(eta*k1)^2)/(1+eta*k1)^2+(c2+d2*(eta*k2)^2)/(1+eta*k2)^2
plot(eta,y,ty="l")
y=2*k1/(1+eta*k1)^3*(eta*k1*d1-c1)+2*k2/(1+eta*k2)^3*(eta*k2*d2-c2)
plot(eta,y,ty="l")
k1=0.01
k2=0.01
c1=1
c2=4
d1=1
d2=1
eta=(1:10000)/10
c1/k1/d1
c2/k2/d2
(d1+2*c1)/k1/d1
(d2+2*c2)/k2/d2
w=0
y=(c1+d1*(eta*k1)^2)/(1+eta*k1)^2+(c2+d2*(eta*k2)^2)/(1+eta*k2)^2
plot(eta,y,ty="l")
plot(eta,y,ty="l")
y=2*k1/(1+eta*k1)^3*(eta*k1*d1-c1)+2*k2/(1+eta*k2)^3*(eta*k2*d2-c2)
y[3000]
k1=0.01
k2=0.005
c1=1
c2=2
d1=1
d2=1
eta=(1:10000)/10
c1/k1/d1
c2/k2/d2
(d1+2*c1)/k1/d1
(d2+2*c2)/k2/d2
y=(c1+d1*(eta*k1)^2)/(1+eta*k1)^2+(c2+d2*(eta*k2)^2)/(1+eta*k2)^2
plot(eta,y,ty="l")
k1=0.01
k2=0.005
c1=1
c2=2
d1=1
d2=1
eta=(1:10000)/10
c1/k1/d1
c2/k2/d2
(d1+2*c1)/k1/d1
(d2+2*c2)/k2/d2
w=0
y=w*(c1+d1*(eta*k1)^2)/(1+eta*k1)^2+(1-w)(c2+d2*(eta*k2)^2)/(1+eta*k2)^2
plot(eta,y,ty="l")
k1=0.01
k2=0.005
c1=1
c2=2
d1=1
d2=1
eta=(1:10000)/10
c1/k1/d1
c2/k2/d2
(d1+2*c1)/k1/d1
(d2+2*c2)/k2/d2
w=0
y=w*(c1+d1*(eta*k1)^2)/(1+eta*k1)^2+(1-w)*(c2+d2*(eta*k2)^2)/(1+eta*k2)^2
plot(eta,y,ty="l")
k1=0.01
k2=0.005
c1=1
c2=2
d1=1
d2=1
eta=(1:10000)/10
c1/k1/d1
c2/k2/d2
(d1+2*c1)/k1/d1
(d2+2*c2)/k2/d2
w=1
y=w*(c1+d1*(eta*k1)^2)/(1+eta*k1)^2+(1-w)*(c2+d2*(eta*k2)^2)/(1+eta*k2)^2
plot(eta,y,ty="l")
k1=0.01
k2=0.005
c1=1
c2=2
d1=1
d2=1
eta=(1:10000)/10
c1/k1/d1
c2/k2/d2
(d1+2*c1)/k1/d1
(d2+2*c2)/k2/d2
w=0.5
y=w*(c1+d1*(eta*k1)^2)/(1+eta*k1)^2+(1-w)*(c2+d2*(eta*k2)^2)/(1+eta*k2)^2
plot(eta,y,ty="l")
k1=0.01
k2=0.005
k3=0.01
c1=1
c2=2
c3=3
d1=1
d2=1
d3=1
eta=(1:10000)/10
c1/k1/d1
c2/k2/d2
c3/k3/d3
(d1+2*c1)/k1/d1
(d2+2*c2)/k2/d2
(d3+2*c3)/k3/d3
k1=0.01
k2=0.005
k3=0.02
c1=1
c2=2
c3=6
d1=1
d2=1
d3=1
eta=(1:10000)/10
c1/k1/d1
c2/k2/d2
c3/k3/d3
X=matrix(rnorm(100),nrow=10)
X
X%*%solve(t(X)%*%X)t(X)
X%*%solve(t(X)%*%X)%*%t(X)
3.79+3.79+4.99+4.59+5.79
eta_vec=c(0,exp(seq(log(0.01),log(100),length.out=100)),10000)
eta_vec
1000/60
20*60
1200*6ã€‚87
1200*6.87
library(lassosum)
devtools::install_github("tengfei-emory/lcphR")
library(grepreg)
library(grpreg)
newY <- function(y, family) {
if (is.data.frame(y)) y <- as.matrix(y)
if (is.matrix(y)) {
d <- dim(y)
y <- t(y)
} else {
d <- c(length(y), 1)
}
# Convert fuzzy binomial data
if (family=="binomial" && typeof(y) != "logical") {
tab <- table(y)
if (length(tab) > 2) stop("Attemping to use family='binomial' with non-binary data", call.=FALSE)
if (!identical(names(tab), c("0", "1"))) {
message(paste0("Logistic regression modeling Pr(y=", names(tab)[2], ")"))
y <- as.double(as.character(y) == names(tab)[2])
if (d[2] > 1) attr(y, "dim") <- d
}
}
# Convert to double, if necessary
if (typeof(y) != "double") {
tryCatch(storage.mode(y) <- "double", warning=function(w) {stop("y must be numeric or able to be coerced to numeric", call.=FALSE)})
}
if (any(is.na(y))) stop("Missing data (NA's) detected in outcome y.  You must eliminate missing data (e.g., by removing cases or imputation) before passing y to grpreg", call.=FALSE)
# Handle multi
if (is.matrix(y)) {
if (ncol(y) > 1) {
if (is.null(colnames(y))) paste("Y", 1:ncol(y), sep="")
}
attributes(y) <- NULL
}
if (family=="gaussian") {
meanY <- mean(y)
y <- y - meanY
attr(y, "mean") <- meanY
}
attr(y, "m") <- d[2]
y
}
y=rnorm(10000,mean = 10,sd=10)
ny=newY(y,"gaussian")
mean(ny)
sd(ny)
install.packages("pkgdown")
0.8/log(0.8/0.5)
0.2/log(0.2/0.1)+0.6/log(0.6/0.4)
0.8/log(0.8/0.2)
0.2/log(0.2/0.1)+0.6/log(0.6/0.1)
0.2/log(0.2/0.05)+0.6/log(0.6/0.15)
0.2/log(0.2/0.15)+0.6/log(0.6/0.05)
0.47704/0.18111
0.01896/0.00273
(0.47704/0.18111)^2
c(0.5,0.25,0.2,0.15)
a=c(0.5,0.25,0.2,0.15)
cumsum(a)
var=0.8
data.use=a
which(cumsum(data.use)>var)[1]
a=rnorm(10000000)
var(a)
mean(a)
setwd("~/Desktop/research/Kevin He/PRS/Rewrite_Lassosum/example_2/")
p2cor <- function(p, n, sign=rep(1, length(p))) {
stopifnot(length(n)==1 || length(n) == length(p))
stopifnot(length(p) == length(sign))
t <- sign(sign) * qt(p/2, df=n-2, lower.tail=F)
return(t / sqrt(n - 2 + t^2))
}
for(i in c("SAS1","SAS2","EUR")){
GWAS=read.table(paste(i,".qassoc",sep=""),header=T)
bim=read.table(paste(i,".bim",sep=""),header=F)
print(sum(bim[,2]==GWAS[,2]))
GWAS_rst=data.frame(bim[,1],bim[,4],bim[,5],bim[,6],sign(GWAS[,5]),GWAS[,4],GWAS[,9])
colnames(GWAS_rst)=c("CHR","BP","A1","A2","Sign","N","P")
IProd_rst=data.frame(bim[,1],bim[,4],bim[,5],bim[,6],p2cor(GWAS[,9],GWAS[,4],sign(GWAS[,5])))
colnames(IProd_rst)=c("CHR","BP","A1","A2","IProd")
write.table(GWAS_rst,file=paste(i,".GWAS",sep=""),col.names = T,row.names = F,quote = F)
write.table(IProd_rst,file=paste(i,".IProd",sep=""),col.names = T,row.names = F,quote = F)
}
setwd("~/Desktop/research/Kevin He/PRS/Rewrite_Lassosum/example_2/")
p2cor <- function(p, n, sign=rep(1, length(p))) {
stopifnot(length(n)==1 || length(n) == length(p))
stopifnot(length(p) == length(sign))
t <- sign(sign) * qt(p/2, df=n-2, lower.tail=F)
return(t / sqrt(n - 2 + t^2))
}
for(i in c("SAS1","SAS2","EUR")){
GWAS=read.table(paste(i,".qassoc",sep=""),header=T)
bim=read.table(paste(i,".bim",sep=""),header=F)
print(sum(bim[,2]==GWAS[,2]))
GWAS_rst=data.frame(bim[,1],bim[,4],bim[,5],bim[,6],sign(GWAS[,5]),GWAS[,4],GWAS[,9])
colnames(GWAS_rst)=c("CHR","BP","A1","A2","Sign","N","P")
IProd_rst=data.frame(bim[,1],bim[,4],bim[,5],bim[,6],p2cor(GWAS[,9],GWAS[,4],sign(GWAS[,5])))
colnames(IProd_rst)=c("CHR","BP","A1","A2","IProd")
write.table(GWAS_rst,file=paste(i,".GWAS",sep=""),col.names = T,row.names = F,quote = F)
write.table(IProd_rst,file=paste(i,".IProd",sep=""),col.names = T,row.names = F,quote = F)
}
setwd("~/Desktop/research/Kevin He/PRS/Rewrite_Lassosum/new_BRIGHT/BRIGHT/")
library(devtools)
library(pkgdown)
load_all()
Tind <- "GWAS"
Tss <- read.table("~/Desktop/research/Kevin He/PRS/Rewrite_Lassosum/example_2/SAS1_train.GWAS",header = T)
head(Tss)
Pind <- c("GWAS")
Pss <- read.table("~/Desktop/research/Kevin He/PRS/Rewrite_Lassosum/example_2/EUR.GWAS",header = T)
head(Pss)
Tref <- "~/Desktop/research/Kevin He/PRS/Rewrite_Lassosum/example_2/SAS1_train"
Pref <- "~/Desktop/research/Kevin He/PRS/Rewrite_Lassosum/example_2/EUR"
dat=PreprocessS(Tss, Tind, Tref, Pss, Pind, Pref, TLDblocks=c("SAS.hg19"), PLDblocks=c("EUR.hg19"),TN=100,PN=11514)
#eta_vec=c(0,exp(seq(log(0.1),log(10),length.out=20)))
out <- BRIGHTs(data = dat)
Eta_curve.plot(out,valid.type = "AIC")
setwd("~/Desktop/research/Kevin He/PRS/Rewrite_Lassosum/new_BRIGHT/BRIGHT/")
library(devtools)
library(pkgdown)
load_all()
Tind <- "GWAS"
Tss <- read.table("~/Desktop/research/Kevin He/PRS/Rewrite_Lassosum/example_2/SAS1_train.GWAS",header = T)
head(Tss)
Pind <- c("GWAS")
Pss <- read.table("~/Desktop/research/Kevin He/PRS/Rewrite_Lassosum/example_2/EUR.GWAS",header = T)
head(Pss)
Tref <- "~/Desktop/research/Kevin He/PRS/Rewrite_Lassosum/example_2/SAS1_train"
Pref <- "~/Desktop/research/Kevin He/PRS/Rewrite_Lassosum/example_2/EUR"
dat=PreprocessS(Tss, Tind, Tref, Pss, Pind, Pref, TLDblocks = c("SAS.hg19"), PLDblocks = c("EUR.hg19"), TN = 100, PN = 11514)
#eta_vec=c(0,exp(seq(log(0.1),log(10),length.out=20)))
out <- BRIGHTs(data = dat)
Eta_curve.plot(out,valid.type = "AIC")
setwd("~/Desktop/research/Kevin He/PRS/Rewrite_Lassosum/new_BRIGHT/BRIGHT/")
library(devtools)
library(pkgdown)
load_all()
Tind <- "GWAS"
Tss <- read.table("~/Desktop/research/Kevin He/PRS/Rewrite_Lassosum/example_2/SAS1_train.GWAS",header = T)
head(Tss)
Pind <- c("GWAS")
Pss <- read.table("~/Desktop/research/Kevin He/PRS/Rewrite_Lassosum/example_2/EUR.GWAS",header = T)
head(Pss)
Tref <- "~/Desktop/research/Kevin He/PRS/Rewrite_Lassosum/example_2/SAS1_train"
Pref <- "~/Desktop/research/Kevin He/PRS/Rewrite_Lassosum/example_2/EUR"
dat=PreprocessS(Tss, Tind, Tref, Pss, Pind, Pref, TLDblocks = c("SAS.hg19"), PLDblocks = c("EUR.hg19"), TN = 100, PN = 11514)
setwd("~/Desktop/research/Kevin He/PRS/Rewrite_Lassosum/new_BRIGHT/BRIGHT/")
library(devtools)
library(pkgdown)
load_all()
?p2cor
p=c(0.01,0.015)
n=c(100,1000)
sign=c(-1,1)
p2cor(p,n,sign)
10^-100
10^-200
10^-230
10^-270
10^-300
10^-6000
10^-400
10^-350
10^-330
10^-320
10^-325
10^-322
10^-323
10^-324
10^-325
10^-323
setwd("~/Desktop/research/Kevin He/PRS/Rewrite_Lassosum/new_BRIGHT/BRIGHT/")
library(devtools)
library(pkgdown)
load_all()
?QC
?BRIGHT::QC
?QC
?BRIGHT::QC()
?BRIGHT::p2cor
?BRIGHT::QC
?BRIGHT::PreprocessS
document()
?BRIGHT::QC
document()
?PreprocessS
?PreprocessS
document()
?LASSOsum
setwd("~/Desktop/research/Kevin He/PRS/Rewrite_Lassosum/new_BRIGHT/BRIGHT/")
library(devtools)
library(pkgdown)
load_all()
Tind <- "GWAS"
Tss <- read.table("~/Desktop/research/Kevin He/PRS/Rewrite_Lassosum/example_2/SAS1_train.GWAS",header = T)
head(Tss)
Pind <- c("GWAS")
Pss <- read.table("~/Desktop/research/Kevin He/PRS/Rewrite_Lassosum/example_2/EUR.GWAS",header = T)
head(Pss)
Tref <- "~/Desktop/research/Kevin He/PRS/Rewrite_Lassosum/example_2/SAS1_train"
Pref <- "~/Desktop/research/Kevin He/PRS/Rewrite_Lassosum/example_2/EUR"
dat=PreprocessS(Tss, Tind, Tref, Pss, Pind, Pref, TLDblocks = c("SAS.hg19"), PLDblocks = c("EUR.hg19"), TN = 100, PN = 11514)
#eta_vec=c(0,exp(seq(log(0.1),log(10),length.out=20)))
out <- BRIGHTs(data = dat)
?BRIGHTs
document()
document()
?BRIGHTs
library(grpreg)
?grpreg
?BRIGHTs
document()
?BRIGHTs
setwd("~/Desktop/research/Kevin He/PRS/Rewrite_Lassosum/new_BRIGHT/BRIGHT/")
library(devtools)
library(pkgdown)
load_all()
Tind <- "GWAS"
Tss <- read.table("~/Desktop/research/Kevin He/PRS/Rewrite_Lassosum/example_2/SAS1_train.GWAS",header = T)
head(Tss)
Pind <- c("GWAS")
Pss <- read.table("~/Desktop/research/Kevin He/PRS/Rewrite_Lassosum/example_2/EUR.GWAS",header = T)
head(Pss)
Tref <- "~/Desktop/research/Kevin He/PRS/Rewrite_Lassosum/example_2/SAS1_train"
Pref <- "~/Desktop/research/Kevin He/PRS/Rewrite_Lassosum/example_2/EUR"
out=BRIGHTs.pipeline(Tss, Tind, Tref, Pss, Pind, Pref, TLDblocks = c("SAS.hg19"), PLDblocks = c("EUR.hg19"), TN = 100, PN = 11514)
Eta_curve.plot(out,valid.type = "AIC")
setwd("~/Desktop/research/Kevin He/PRS/Rewrite_Lassosum/new_BRIGHT/BRIGHT/")
library(devtools)
library(pkgdown)
load_all()
Tind <- "GWAS"
Tss <- read.table("~/Desktop/research/Kevin He/PRS/Rewrite_Lassosum/example_2/SAS1_train.GWAS",header = T)
head(Tss)
Pind <- c("GWAS")
Pss <- read.table("~/Desktop/research/Kevin He/PRS/Rewrite_Lassosum/example_2/EUR.GWAS",header = T)
head(Pss)
Tref <- "~/Desktop/research/Kevin He/PRS/Rewrite_Lassosum/example_2/SAS1_train"
Pref <- "~/Desktop/research/Kevin He/PRS/Rewrite_Lassosum/example_2/EUR"
out=BRIGHTs.pipeline(Tss, Tind, Tref, Pss, Pind, Pref, TLDblocks = c("SAS.hg19"), PLDblocks = c("EUR.hg19"), TN = 100, PN = 11514)
EUR.hg19=read.table("../../Berisa/Berisa.EUR.hg19.bed")
head(EUR.hg38)
EUR.hg19=read.table("../../Berisa/Berisa.EUR.hg19.bed",header = T)
head(EUR.hg19)
EUR.hg38=read.table("../../Berisa/Berisa.EUR.hg38.bed",header = T)
AFR.hg38=read.table("../../Berisa/Berisa.AFR.hg38.bed",header = T)
ASN.hg38=read.table("../../Berisa/Berisa.ASN.hg38.bed",header = T)
AFR.hg19=read.table("../../Berisa/Berisa.AFR.hg19.bed",header = T)
ASN.hg19=read.table("../../Berisa/Berisa.ASN.hg19.bed",header = T)
save(EUR.hg19,EUR.hg38,AFR.hg19,AFR.hg38,ASN.hg19,ASN.hg38,file="../../Berisa/Berisa.LD.rda")
c(1,NA,2)>1
c(1,NA,2)[c(1,NA,2)>1]
getwd()
librar
library(devtools)
library(pkgdown)
load_all()
build_site()
build_site()
build_site()
build_site()
build_site()
build_site()
build_site()
build_site()
library(devtools)
library(pkgdown)
load_all()
build_site()
build_site()
library(devtools)
library(pkgdown)
build_site()
load_all()
load_all()
build_site()
getwd()
library(devtools)
load_all()
library(pkgdown)
build_site()
build_site()
library(devtools)
load()
load_all()
library(devtools)
load_all()
library(devtools)
load_all()
install.packages("cpp11")
usethis::use_cpp11()
load_all()
require(devtools)
install_version("Rcpp", version = "1.0.12", repos = "http://cran.us.r-project.org")
packageVersion("Rcpp")
library(devtools)
load_all()
require(devtools)
install_version("Rcpp", version = "1.0.14", repos = "http://cran.us.r-project.org")
load_all
load_all()
load_all()
library(devtools)
load_all
load_all()
load_all()
load_all()
library(devtools)
library(roxygen2)
library(Rcpp)
load_all()
