<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>BRIGHT estimation procedure for individual level data — BRIGHTi • BRIGHT</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="BRIGHT estimation procedure for individual level data — BRIGHTi"><meta property="og:description" content="Fit BRIGHT estimation procedure for individual level data with grouped penalties over a grid of values of the regularization parameter lambda."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">BRIGHT</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/BRIGHT.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/BRIGHTi.html">BRIGHTi tutorial</a>
    </li>
    <li>
      <a href="../articles/BRIGHTs.html">BRIGHTs tutorial</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/UM-KevinHe/BRIGHT/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>BRIGHT estimation procedure for individual level data</h1>
    <small class="dont-index">Source: <a href="https://github.com/UM-KevinHe/BRIGHT/blob/HEAD/R/BRIGHT.R" class="external-link"><code>R/BRIGHT.R</code></a></small>
    <div class="hidden name"><code>BRIGHTi.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Fit BRIGHT estimation procedure for individual level data with grouped penalties over a grid of values of the regularization parameter lambda.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">BRIGHTi</span><span class="op">(</span></span>
<span>  <span class="va">X_plink</span>,</span>
<span>  <span class="va">Y</span>,</span>
<span>  group <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span>,</span>
<span>  <span class="va">Beta_prior</span>,</span>
<span>  penalty <span class="op">=</span> <span class="st">"grLasso"</span>,</span>
<span>  family <span class="op">=</span> <span class="st">"gaussian"</span>,</span>
<span>  <span class="va">eta</span>,</span>
<span>  <span class="va">lambda</span>,</span>
<span>  <span class="va">lambda.min</span>,</span>
<span>  tau <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="fl">3</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  gamma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">penalty</span> <span class="op">==</span> <span class="st">"grSCAD"</span>, <span class="fl">4</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>  eps <span class="op">=</span> <span class="fl">1e-07</span>,</span>
<span>  max_iter <span class="op">=</span> <span class="fl">1e+06</span>,</span>
<span>  dfmax <span class="op">=</span> <span class="fl">5000</span>,</span>
<span>  gmax <span class="op">=</span> <span class="fl">5000</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>group</dt>
<dd><p>A vector describing the grouping of the coefficients.  For
greatest efficiency and least ambiguity (see details), it is best if
<code>group</code> is a factor or vector of consecutive integers, although
unordered groups and character vectors are also allowed.  If there are
coefficients to be included in the model without being penalized, assign
them to group 0 (or <code>"0"</code>).</p></dd>


<dt>Beta_prior</dt>
<dd><p>a numeric verticle vector of the prior information; in the case where prior information is a subspace of XtY, set the complement set to be zero.</p></dd>


<dt>penalty</dt>
<dd><p>the penalty to be applied to the model.  For group selection,
one of <code>grLasso</code>, <code>grMCP</code>, or <code>grSCAD</code>.</p></dd>


<dt>family</dt>
<dd><p>either "gaussian" or "binomial", depending on the response.</p></dd>


<dt>eta</dt>
<dd><p>a numeric scalar of the weights for incorporating prior information.</p></dd>


<dt>lambda</dt>
<dd><p>a user supplied sequence of <code>lambda</code> values.  Typically,
this is left unspecified, and the function automatically computes a grid of
lambda values that ranges uniformly on the log scale over the relevant range
of lambda values.</p></dd>


<dt>lambda.min</dt>
<dd><p>the smallest value for <code>lambda</code>, as a fraction of
<code>lambda.max</code>.  Default is .0001 if the number of observations is larger
than the number of covariates and .05 otherwise.</p></dd>


<dt>tau</dt>
<dd><p>tuning parameter for the group exponential lasso; defaults to
1/3.</p></dd>


<dt>alpha</dt>
<dd><p><code>grpreg</code> allows for both a group penalty and an L2 (ridge)
penalty; <code>alpha</code> controls the proportional weight of the regularization
parameters of these two penalties.  The group penalties' regularization
parameter is <code>lambda*alpha</code>, while the regularization parameter of the
ridge penalty is <code>lambda*(1-alpha)</code>.  Default is 1: no ridge penalty.</p></dd>


<dt>gamma</dt>
<dd><p>tuning parameter of the group or composite MCP/SCAD penalty
(see details).  Default is 3 for MCP and 4 for SCAD.</p></dd>


<dt>eps</dt>
<dd><p>convergence threshhold.  The algorithm iterates until the RMSD
for the change in linear predictors for each coefficient is less than
<code>eps</code>.  Default is <code>1e-4</code>.  See details.</p></dd>


<dt>dfmax</dt>
<dd><p>limit on the number of parameters allowed to be nonzero.  If
this limit is exceeded, the algorithm will exit early from the
regularization path.</p></dd>


<dt>gmax</dt>
<dd><p>limit on the number of groups allowed to have nonzero elements.
If this limit is exceeded, the algorithm will exit early from the
regularization path.</p></dd>


<dt>X_bed</dt>
<dd><p>the genotype matrix directory stored as plink .bed format.  <code>BRIGHT</code> automatically load it and standardizes the data.</p></dd>


<dt>y</dt>
<dd><p>the response vector.</p></dd>


<dt>max.iter</dt>
<dd><p>maximum number of iterations (total across entire path).
Default is 10000.  See details.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>An object with S3 class <code>"grpreg"</code> containing:</p><dl><dt>beta</dt>
<dd><p>The fitted matrix of coefficients.  The number of rows is equal
to the number of coefficients, and the number of columns is equal to
<code>nlambda</code>.</p></dd>

<dt>family</dt>
<dd><p>Same as above.</p></dd>

<dt>group</dt>
<dd><p>Same as above.</p></dd>

<dt>lambda</dt>
<dd><p>The sequence of <code>lambda</code> values in the path.</p></dd>

<dt>alpha</dt>
<dd><p>Same as above.</p></dd>

<dt>loss</dt>
<dd><p>A vector containing either the residual sum of squares (`"gaussian"`) or negative log-likelihood (`"binomial"`) of the fitted model at each value of `lambda`.</p></dd>

<dt>n</dt>
<dd><p>Number of observations.</p></dd>

<dt>penalty</dt>
<dd><p>Same as above.</p></dd>

<dt>df</dt>
<dd><p>A vector of length `nlambda` containing estimates of effective number of model parameters all the points along the regularization path.  For details on how this is calculated, see Breheny and Huang (2009).</p></dd>

<dt>iter</dt>
<dd><p>A vector of length `nlambda` containing the number of iterations until convergence at each value of `lambda`.</p></dd>

<dt>group.multiplier</dt>
<dd><p>A named vector containing the multiplicative constant applied to each group's penalty.</p></dd>


</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>For more information about the penalties and their properties, please
consult the references below, many of which contain discussion, case
studies, and simulation studies comparing the methods.  If you use
<code>BRIGHT</code> for an analysis, please cite the appropriate reference.</p>
<p>In keeping with the notation from the original MCP paper, the tuning
parameter of the MCP penalty is denoted 'gamma'.  Note, however, that in
Breheny and Huang (2009), <code>gamma</code> is denoted 'a'.</p>
<p>The objective function for <code>BRIGHTi</code> optimization is defined to be
$$Q(\beta)=||y-X\beta||/2n+||X\beta'-X\beta||/2n+p(\beta),$$  where the first term on the right hand side (RHS) is
the OLS loss; the second term on the RHS is the Bregman-divergence; the third term on the RHS is the penalty.</p>
<p>The algorithms employed by <code>BRIGHT</code> are stable and generally converge
quite rapidly to values close to the solution.  However, especially when p
is large compared with n, <code>BRIGHT</code> may fail to converge at low values
of <code>lambda</code>, where models are nonidentifiable or nearly singular.
Often, this is not the region of the coefficient path that is most
interesting.  The default behavior warning the user when convergence
criteria are not met may be distracting in these cases, and can be modified
with <code>warn</code> (convergence can always be checked later by inspecting the
value of <code>iter</code>).</p>
<p>If models are not converging, increasing <code>max.iter</code> may not be the most
efficient way to correct this problem.  Consider increasing <code>n.lambda</code>
or <code>lambda.min</code> in addition to increasing <code>max.iter</code>.</p>
<p>Although <code>BRIGHT</code> allows groups to be unordered and given arbitary
names, it is recommended that you specify groups as consecutive integers.
The first reason is efficiency: if groups are out of order, <code>X</code> must be
reordered prior to fitting, then this process reversed to return
coefficients according to the original order of <code>X</code>.  This is
inefficient if <code>X</code> is very large.  The second reason is ambiguity with
respect to other arguments such as <code>group.multiplier</code>.  With
consecutive integers, <code>group=3</code> unambiguously denotes the third element
of <code>group.multiplier</code>.</p>
<p><code>BRIGHT</code> requires groups to be non-overlapping.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    
<ul><li><p>Li Q, Patrick MT, Zhang H, Khunsriraksakul C, Stuart PE, Gudjonsson JE,
 Nair R, Elder JT, Liu DJ, Kang J, Tsoi LC. Bregman Divergence-Based Data 
 Integration with Application to Polygenic Risk Score (PRS) Heterogeneity Adjustment.
  arXiv preprint arXiv:2210.06025. 2022 Oct 12.</p></li>
<li><p>Breheny P and Huang J. (2009) Penalized methods for bi-level variable
selection. *Statistics and its interface*, **2**: 369-380.
doi: <a href="https://doi.org/10.4310/sii.2009.v2.n3.a10" class="external-link">10.4310/sii.2009.v2.n3.a10</a></p></li>
<li><p>Huang J, Breheny P, and Ma S. (2012). A selective review of group
selection in high dimensional models. *Statistical Science*, **27**: 481-499.
doi: <a href="https://doi.org/10.1214/12-sts392" class="external-link">10.1214/12-sts392</a></p></li>
<li><p>Breheny P and Huang J. (2015) Group descent algorithms for nonconvex
penalized linear and logistic regression models with grouped predictors.
*Statistics and Computing*, **25**: 173-187. doi: <a href="https://doi.org/10.1007/s11222-013-9424-2" class="external-link">10.1007/s11222-013-9424-2</a></p></li>
<li><p>Breheny P. (2015) The group exponential lasso for bi-level variable
selection. *Biometrics*, **71**: 731-740. doi: <a href="https://doi.org/10.1111/biom.12300" class="external-link">10.1111/biom.12300</a></p></li>
</ul></div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p>[BRIGHTs()] methods.</p></div>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Qinmengge Li</p>
    </div>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Qinmengge Li.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

