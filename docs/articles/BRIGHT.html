<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>BRIGHT • BRIGHT</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="BRIGHT">
<meta property="og:description" content="BRIGHT">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">BRIGHT</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/BRIGHT.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/BRIGHTi.html">BRIGHTi tutorial</a>
    </li>
    <li>
      <a href="../articles/BRIGHTs.html">BRIGHTs tutorial</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>BRIGHT</h1>
                        <h4 data-toc-skip class="author">Qinmengge Li</h4>
            
            <h4 data-toc-skip class="date">5/1/2023</h4>
      
      
      <div class="hidden name"><code>BRIGHT.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>PRS is a widely used tool for genetic risk prediction, but its performance is limited in minority populations. This motivates the development of a transfer learning procedure to leverage knowledge from well-studied majority populations. However, the lack of individual-level data access poses a challenge. To address this, we propose a privacy-preserving technique called BRegman divergence-based Integrational Genetic Hazard Trans-ethnic (BRIGHT).</p>
<p>BRIGHT is implemented in the software package BRIGHT, which offers two versions of the model: BRIGHTi and BRIGHTs. BRIGHTi integrates individual-level data from the target minority population and either summary-level or individual-level data from the prior majority population. In comparison, BRIGHTs integrates summary-level data from target minority population, ensuring privacy protection. Both versions of BRIGHT support general penalty structures for fine mapping of genetic markers.</p>
<p>By using BRIGHT, researchers can overcome the limitations of single-ethnic PRS and improve prediction accuracy for minority populations. The package provides a valuable tool for transferring knowledge and optimizing the integration of information between populations with heterogeneous genetic backgrounds.</p>
<p>To summarize, BRIGHT estimation procedure utilize Bregman-divergence to measure the difference between the populations and optimally balance the information from them. The method enjoys the following properties :</p>
<ul>
<li>it controls the relative weight of the external information, identifying the most compatible ones and diminishing the weights of less relevant ones;</li>
<li>it is robust to model misspecification and incorporates various types of external risk scores, including risk scores derived from different statistical models or built upon different outcomes;</li>
<li>it accommodates that the covariate space may be different between data sources;</li>
<li>less sensitive summary statistics from prior (and target) data sources suffice the model fitting of BRIGHT (BRIGHTs);</li>
<li>it achieves fine-mapping simultaneously in the process of PRS construction;</li>
<li>its objective function retains similar forms as the penalized regression and guarantees the computation efficiency;</li>
<li>it incorporates pLASSO  and LASSOsum  as special cases.</li>
</ul>
<p>The detailed BRIGHT model can be found in the Appendix </p>
<p>The BRIGHT estimation procedure allows for the incorporation of various types of individual or summary-level information from the prior majority population in the construction of BRIGHT PRS:</p>
<ul>
<li>PRS coefficients (weight file) from the prior majority population.</li>
<li>GWAS summary statistics from the prior majority population.</li>
<li>Individual-level data from the prior majority population.</li>
</ul>
<p>Moreover, the BRIGHT estimation procedure can also incorporate flexible individual-level or summary-level information from the target minority population in the construction of <span class="math inline">\(\boldsymbol{\hat\beta}\)</span>. The specific data requirements for each setting are discussed separately in the following sections.</p>
<p>The flowchart for major functions and the pipeline can be found below.</p>
<div class="figure">
<embed src="./Figure1_full_LD.pdf" style="width:100.0%" height="500"></embed><p class="caption">Alt</p>
</div>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p><code>BRIGHT</code> requires the following R packages: <code>Rcpp</code>, <code>Matrix</code>, <code>mvtnorm</code>, <code>BEDMatrix</code>, <code>grpreg</code>. Install them by:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Rcpp"</span>, <span class="st">"Matrix"</span>, <span class="st">"mvtnorm"</span>, <span class="st">"BEDMatrix"</span>, <span class="st">"grpreg"</span><span class="op">)</span>, dependencies<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>For Windows and Mac users, it would be easiest to download the following binaries (<a href="To%20be%20determined">Windows</a>, <a href="To%20be%20determined">Mac</a>) and install using:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"/path/to/downloaded_binary_file"</span>, repos<span class="op">=</span><span class="cn">NULL</span><span class="op">)</span></span></code></pre></div>
<p>If you are on Linux or you would like to compile from source, you can download the source codes <a href="To%20be%20determined">BRIGHT_0.0.1.tar.gz</a>. Mac users should refer to <a href="https://cran.r-project.org/bin/macosx/tools/" class="external-link">this page</a> for the various dependencies required. Install then via:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"/path/to/downloaded_source.tar.gz"</span>, repos<span class="op">=</span><span class="cn">NULL</span>, type<span class="op">=</span><span class="st">"source"</span><span class="op">)</span></span></code></pre></div>
<p>If you have <code>devtools</code>, you can also type:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">install_github</span><span class="op">(</span><span class="st">"To be determined"</span><span class="op">)</span></span></code></pre></div>
<p>or</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">install_github</span><span class="op">(</span><span class="st">"To be determined"</span><span class="op">)</span></span></code></pre></div>
<p>for the latest development version. Or you can clone the latest development version here and install yourself using <code>devtools</code>.</p>
</div>
<div class="section level2">
<h2 id="warning">Warning!<a class="anchor" aria-label="anchor" href="#warning"></a>
</h2>
<p>Most functions in <code>BRIGHT</code> impute missing genotypes in PLINK bfiles with a homozygous A2 genotype, which is the same as using the <code>--fill-missing-a2</code> option in PLINK. It is the user’s responsibility to filter out individuals and SNPs with too many missing genotypes beforehand.</p>
</div>
<div class="section level2">
<h2 id="quick-start">Quick Start<a class="anchor" aria-label="anchor" href="#quick-start"></a>
</h2>
<p>In this section, we present a toy example to demonstrate the main functions, basic usage, and output results of the  package. This example serves as an introduction to the package’s capabilities, and we will delve into the different versions of BRIGHT and their specific applications in the subsequent sections.</p>
<div class="section level3">
<h3 id="toy-example-illustration">Toy example illustration<a class="anchor" aria-label="anchor" href="#toy-example-illustration"></a>
</h3>
<p>First, we load the BRIGHT package:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">BRIGHT</span><span class="op">)</span></span></code></pre></div>
<p>In the default version of the  package, the implemented method is BRIGHTs with quantitative traits, which integrates summary-level information from both the target and prior data. In this section, we will demonstrate the application of this method using a toy example. Let’s load the pre-simulated toy example data for illustration:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">ToyExample</span><span class="op">)</span></span></code></pre></div>
<p>The toy example contains the summary statistics from both target and prior population and the directory of the PLINK1 file for reference LD construction.</p>
</div>
<div class="section level3">
<h3 id="bright-fitting-and-visualization">BRIGHT fitting and visualization<a class="anchor" aria-label="anchor" href="#bright-fitting-and-visualization"></a>
</h3>
<p>The BRIGHT method is fit by using the basic function <code>BRIGHT</code> with LASSO penalty on quantitative traits by default:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/BRIGHT-package.html">BRIGHT</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">dat</span><span class="op">)</span></span></code></pre></div>
<p><code>out</code> is a list object containing all the information from the fitting of BRIGHT.</p>
</div>
<div class="section level3">
<h3 id="hyperparameter-fine-tuning-with-individual-level-validation-data">Hyperparameter fine-tuning with individual-level validation data<a class="anchor" aria-label="anchor" href="#hyperparameter-fine-tuning-with-individual-level-validation-data"></a>
</h3>
<p><code>out</code> contains a sequence of models corresponding to different hyperparameters, <span class="math inline">\(\lambda\)</span> and <span class="math inline">\(\eta\)</span> pairs. Users would prefer to select the best performance model for the purpose of constructing PRS. Due to only summary statistics being available for the target minority populations, the widely used cross-validation is not applicable for hyper-parameter fine-tuning. Here our package provide two functions for using either individual-level or summary-level validation data to fine-tune hyperparameters. When individual-level validation data is available, users can use <code>Valid.Ind</code> to choose the best performance model:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Perform validation with individual-level validation data</span></span>
<span><span class="va">Val</span> <span class="op">&lt;-</span> <span class="fu">Valid.Ind</span><span class="op">(</span><span class="va">out</span>, <span class="va">Valipheno</span>, <span class="va">Valigeno</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Extracting number of samples and rownames from SAS2.fam...</span></span></code></pre>
<pre><code><span><span class="co">## Extracting number of variants and colnames from SAS2.bim...</span></span></code></pre>
<pre><code><span><span class="co">## [1] "Best eta based on R2 is 1.833"</span></span>
<span><span class="co">## [1] "Best lambda based on R2 is 0.056"</span></span>
<span><span class="co">## [1] "Best eta based on MSPE is 1.833"</span></span>
<span><span class="co">## [1] "Best lambda based on MSPE is 0.044"</span></span></code></pre>
<p>Once validation is done evaluation plots can be generated by using Contour.plot functions provided by the package:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Plot Contour plots</span></span>
<span><span class="fu">Contour.plot</span><span class="op">(</span><span class="va">Val</span><span class="op">)</span></span></code></pre></div>
<p><embed src="./R2.pdf" style="width:100.0%" height="700"></embed><embed src="./MSPE.pdf" style="width:100.0%" height="700"></embed></p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Plot MSPE and R2 plot</span></span>
<span><span class="fu">MSPE_R2.plot</span><span class="op">(</span><span class="va">Val</span><span class="op">)</span></span></code></pre></div>
<p><img src="BRIGHT_files/figure-html/unnamed-chunk-6-1.png" width="960"> The plots generated by “MSPE_R2.plot” presents the mean squared prediction error (MSPE) and <span class="math inline">\(R^2\)</span>, measuring calibration and discrimination, for local (squares), prior (triangle), and BRIGHT (lines with circles) with varying <span class="math inline">\(\eta\)</span> values and <span class="math inline">\(\lambda\)</span> values. These plots help the user to visualize the local model’s small sample size and prior model’s heterogeneity effect on their recalibration and discrimination performance. The BRIGHT performance associated with varying <span class="math inline">\(\eta\)</span> and <span class="math inline">\(\lambda\)</span> values helps to decide how much information should be borrowed from the prior majority data and how many covariates should be chosen in order to achieve optimal performance for BRIGHT.</p>
<p>Then the coefficients from the best performance model can be visualized in the following solution path plots by using function <code>Sol_path_valid.plot</code>:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Plot solution path containing either best selected eta or best selected lambda</span></span>
<span><span class="fu">Sol_path_valid.plot</span><span class="op">(</span><span class="va">Val</span>,<span class="va">out</span>,highlight<span class="op">=</span><span class="va">Ground_truth</span>,criteria<span class="op">=</span><span class="st">"R2"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "***"</span></span></code></pre>
<p><img src="BRIGHT_files/figure-html/unnamed-chunk-7-1.png" width="960"> After selecting the criteria, either “R2” or “MSPE”, for model fine-tuning, the solution paths for <span class="math inline">\(-log(\lambda)\)</span> and <span class="math inline">\(\eta\)</span> are plot for the best <span class="math inline">\(\eta\)</span> and <span class="math inline">\(\lambda\)</span>, respectively. Each line corresponds to a covariate (SNPs). The left plot shows the solution path of effect sizes over the change of <span class="math inline">\(-log(\lambda)\)</span> for a given <span class="math inline">\(\eta\)</span> (<span class="math inline">\(\eta=0\)</span> in the above case); the right plot shows the solution path of effect sizes over the change of <span class="math inline">\(\eta\)</span> for a given <span class="math inline">\(\lambda\)</span> (<span class="math inline">\(\lambda=0.353\)</span> in the above case).</p>
</div>
<div class="section level3">
<h3 id="hyperparameter-fine-tuning-with-summary-level-validation-data">Hyperparameter fine-tuning with summary-level validation data<a class="anchor" aria-label="anchor" href="#hyperparameter-fine-tuning-with-summary-level-validation-data"></a>
</h3>
<p>However, due to Datashield constraints individual-level validation dataset can be hard to access. Therefore, we provide an alternative validation criteria, approximated MSPE (AMSPE), which only requires summary-level information from validation data. We first read in and present the summary level validation data as well as the Reference LD required for this approximation:</p>
<p>AMSPE is then calculated by executing the <code>Val.Sum</code> function.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Perform validation with summary-level validation data</span></span>
<span><span class="va">Val.Sum</span> <span class="op">&lt;-</span> <span class="fu">Valid.Sum</span><span class="op">(</span><span class="va">out</span>, <span class="va">ValiIProd</span>, <span class="va">ValiRef</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Extracting number of samples and rownames from SAS2.fam...</span></span></code></pre>
<pre><code><span><span class="co">## Extracting number of variants and colnames from SAS2.bim...</span></span></code></pre>
<pre><code><span><span class="co">## [1] "Best eta based on AMSPE is 0.886"</span></span>
<span><span class="co">## [1] "Best lambda based on AMSPE is 0.082"</span></span></code></pre>
<p>Similar to the individual-level validation approach, we can visualize the validation process by plotting the AMSPE with regards to each hyper-parameter and the coefficients by plotting the solution paths.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Plot AMSPE plot</span></span>
<span><span class="fu">AMSPE.plot</span><span class="op">(</span><span class="va">Val.Sum</span><span class="op">)</span></span></code></pre></div>
<p><img src="BRIGHT_files/figure-html/unnamed-chunk-10-1.png" width="960"></p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Plot solution path containing either best selected eta or best selected lambda</span></span>
<span><span class="fu">Sol_path_valid.plot</span><span class="op">(</span><span class="va">Val.Sum</span>,<span class="va">out</span>,highlight<span class="op">=</span><span class="va">Ground_truth</span>,criteria<span class="op">=</span><span class="st">"AMSPE"</span><span class="op">)</span></span></code></pre></div>
<p><img src="BRIGHT_files/figure-html/unnamed-chunk-11-1.png" width="960"></p>
</div>
<div class="section level3">
<h3 id="model-testing-based-on-individual-level-testing-data">Model testing based on individual-level testing data<a class="anchor" aria-label="anchor" href="#model-testing-based-on-individual-level-testing-data"></a>
</h3>
<p>Finally, with the existence of individual-level testing data, we also provide functions to automatically test the performance of the BRIGHT model with comparison to using either data source only.</p>
<p>We present the required format of the individual-level testing data.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Individual level validation data is available, Valipheno is the PLINK1 .fam format phenotype file, and Valigeno is the directory to the PLINK1 .bed file. </span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">Testpheno</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   V1     V2         V3</span></span>
<span><span class="co">## 1  0 711676   9.415242</span></span>
<span><span class="co">## 2  0 711677  20.729158</span></span>
<span><span class="co">## 3  0 711679   8.834436</span></span>
<span><span class="co">## 4  0 711680   8.004271</span></span>
<span><span class="co">## 5  0 711681 -11.331491</span></span>
<span><span class="co">## 6  0 711682  -2.485393</span></span></code></pre>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">Testgeno</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "~/Desktop/research/Kevin He/PRS/Rewrite_Lassosum/example/SAS2"</span></span></code></pre>
<p>Then, model testing can be automatically achieved by executing function <code>Test.Ind</code> function.</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Perform validation with individual-level validation data</span></span>
<span><span class="va">Tst</span> <span class="op">&lt;-</span> <span class="fu">Test.Ind</span><span class="op">(</span><span class="va">Val</span>, <span class="va">Testpheno</span>, <span class="va">Testgeno</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Extracting number of samples and rownames from SAS2.fam...</span></span></code></pre>
<pre><code><span><span class="co">## Extracting number of variants and colnames from SAS2.bim...</span></span></code></pre>
<p>We provide two plotting functions below for easier visualization of testing results:</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Plot density plot</span></span>
<span><span class="fu">Density.plot</span><span class="op">(</span><span class="va">Tst</span>,Pct<span class="op">=</span><span class="fl">0.9</span>,criteria <span class="op">=</span> <span class="st">"R2"</span><span class="op">)</span></span></code></pre></div>
<p><img src="BRIGHT_files/figure-html/unnamed-chunk-15-1.png" width="960"> The plots generated by “Density.plot” presents the distribution of continuous traits in test data stratified by a percentile cut-off (Pct) of the local, prior and BRIGHT PRS. These plots further visualize the discrimination power of each PRS model. In the plots, we compare the median distance between the upper and lower percentile PRS stratification of the observed outcome distribution, and show the distance in the title of the plots.</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Plot ROC plot</span></span>
<span><span class="fu">ROC.plot</span><span class="op">(</span><span class="va">Tst</span>,Pct<span class="op">=</span><span class="fl">0.9</span>,criteria <span class="op">=</span> <span class="st">"R2"</span><span class="op">)</span></span></code></pre></div>
<p><img src="BRIGHT_files/figure-html/unnamed-chunk-16-1.png" width="480"> The plots generated by “ROC.plot” presents the receiver operating characteristic (ROC) curve as well as the area under curve (AUC) measuring the prediction performance of local, prior, and BRIGHT PRS for a given threshold of the continuous traits (Pct).</p>
</div>
</div>
<div class="section level2">
<h2 id="brights-with-summary-level-data-type-traitquantitative-default">BRIGHTs with summary-level data: type.trait=“quantitative” (Default)<a class="anchor" aria-label="anchor" href="#brights-with-summary-level-data-type-traitquantitative-default"></a>
</h2>
<p>For quantitative traits, we set <span class="math inline">\(B_{\widetilde{\boldsymbol\Sigma}}(\boldsymbol{\hat\beta}||\boldsymbol\beta)=(\boldsymbol{\hat\beta}-\boldsymbol{\beta})^\top\widetilde{\boldsymbol\Sigma}(\boldsymbol{\hat\beta}-\boldsymbol{\beta})/n\)</span>, <span class="math inline">\(B_{\widetilde{\boldsymbol\Sigma}}(\boldsymbol{\check\beta}||\boldsymbol\beta)=(\boldsymbol{\check\beta}-\boldsymbol{\beta})^\top\widetilde{\boldsymbol\Sigma}(\boldsymbol{\check\beta}-\boldsymbol{\beta})/n\)</span> and <span class="math inline">\(\boldsymbol{\hat\beta}=\widetilde{\boldsymbol\Sigma}^{-1}\boldsymbol r\)</span> where <span class="math inline">\(\boldsymbol r=\frac{\boldsymbol y^\top\boldsymbol X}{n}\)</span> is the marginal SNPs-trait inner product from target minority population, where <span class="math inline">\(\boldsymbol X\)</span> and <span class="math inline">\(\boldsymbol y\)</span> are the target genotype matrix and outcome vector respectively. A standardized version, <span class="math inline">\(\boldsymbol r^*=\frac{\boldsymbol y^{*\top}\boldsymbol X^*}{n}\)</span>, can be recovered from GWAS summary statistics with <span class="math inline">\(\boldsymbol X^*\)</span> and <span class="math inline">\(\boldsymbol y^*\)</span> being the standardized genotype and phenotype . The above definition of <span class="math inline">\(B_{\widetilde{\boldsymbol\Sigma}}(\boldsymbol{\hat\beta}||\boldsymbol\beta)\)</span> and <span class="math inline">\(\boldsymbol{\hat\beta}\)</span> ensures <span class="math inline">\(B_{\widetilde{\boldsymbol\Sigma}}(\boldsymbol{\hat\beta}||\boldsymbol\beta)\)</span> to be a valid approximation of the OLS loss through <span class="math inline">\(\widetilde{\boldsymbol\Sigma}\approx\widehat{\boldsymbol\Sigma}\)</span> , which is widely deemed to be true in genetics studies . We note, in this scenario, <span class="math inline">\(\boldsymbol{\hat\beta}\)</span> is only presented for illustration purposes, the actual implementation does not require the inversion or invertibility of <span class="math inline">\(\widetilde{\boldsymbol\Sigma}\)</span>. The objective function in this case can be reduced to <span class="math display">\[\begin{align}
Q_{BRIGHTs}(\boldsymbol\beta)&amp;\propto\frac{1}{2}\boldsymbol{\beta}^\top \widetilde{\boldsymbol\Sigma}\boldsymbol{\beta}-\boldsymbol{\beta}^\top\boldsymbol{r}+\eta \left ( \frac{1}{2}\boldsymbol{\beta}^\top \widetilde{\boldsymbol\Sigma}\boldsymbol{\beta}-\boldsymbol{\beta}^\top\widetilde{\boldsymbol\Sigma}\boldsymbol{\check\beta}\right )+p_{\lambda}(\boldsymbol\beta). \label{eq: GWAS objective function}
\end{align}\]</span> The above objective function, (), ignoring the penalty term, is of quadratic forms concerning <span class="math inline">\(\boldsymbol\beta\)</span>; therefore, in this package, we efficiently implement the optimization by group coordinate descent algorithm  and warm start and active set technique and the computation cost does not exceed penalized linear regression. Furthermore, the BRIGHTs method will reduce to LASSOsum  when <span class="math inline">\(\eta=0\)</span> and <span class="math inline">\(p_{\lambda}(\boldsymbol\beta)\)</span> is chosen as LASSO penalty.</p>
<p>BRIGHTs methods for quantitative traits utilize a wide variety of summary-level data from different populations to carry out transfer-learning: from the target minority population, BRIGHTs requires the GWAS summary statistics or marginal genotype-trait inner product (<span class="math inline">\(\boldsymbol r\)</span>/<span class="math inline">\(\boldsymbol r^*\)</span>), while from the prior majority populations either GWAS summary statistics, marginal genotype-trait inner product, or coefficients estimated from joint models (e.g. PRS or LASSO regression) can be used for model fitting. In addition, <span class="math inline">\(\boldsymbol{\hat\beta}\)</span> and <span class="math inline">\(\boldsymbol{\check\beta}\)</span> are only required to contain a subset of markers from the LD reference, <span class="math inline">\(\widetilde{\boldsymbol\Sigma}\)</span>, and no further assumptions are made on the covariate space of <span class="math inline">\(\boldsymbol{\hat\beta}\)</span> or <span class="math inline">\(\boldsymbol{\check\beta}\)</span>. Summary statistics are expected to be loaded into memory as a data.frame/data.table.</p>
<p>Below we present the required data and implementation tutorials for quantitative traits with summary-level target data, for binary traits please refer to <a href="https://github.com/UM-KevinHe/BRIGHT/tree/main/docs/articles/BRIGHTs.html#Introduction" class="external-link">“BRIGHTs”</a>.</p>
<p>First, we load the package and read in the minority summary statistics into R. As discussed, there are two options of summary statistics to be used for minority populations, below we present the two options separately and note in real application only one of the data is required.</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">BRIGHT</span><span class="op">)</span></span></code></pre></div>
<p>The first option of summary-level data for minority population is the marginal inner-product of SNPs and traits</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">### Read target minority marginal genotype-trait inner product file###</span></span>
<span></span>
<span><span class="co"># Read in target GWAS</span></span>
<span><span class="va">Tind</span><span class="op">=</span><span class="st">"IProd"</span></span>
<span><span class="va">Tss</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.table</a></span><span class="op">(</span><span class="st">"~/Desktop/research/Kevin He/PRS/Rewrite_Lassosum/example/SAS1.IProd"</span>,header <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">Tss</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   CHR     BP A1 A2       IProd</span></span>
<span><span class="co">## 1   1 753405  A  C  0.02172325</span></span>
<span><span class="co">## 2   1 754192  G  A  0.02438882</span></span>
<span><span class="co">## 3   1 757640  A  G  0.01932536</span></span>
<span><span class="co">## 4   1 758626  T  C  0.01601668</span></span>
<span><span class="co">## 5   1 769223  G  C -0.01078045</span></span>
<span><span class="co">## 6   1 777122  T  A  0.01340563</span></span></code></pre>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">### Read target minority GWAS summary statistics file###</span></span>
<span></span>
<span><span class="co"># Read in target GWAS</span></span>
<span><span class="va">Tind</span><span class="op">=</span><span class="st">"GWAS"</span></span>
<span><span class="va">Tss</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.table</a></span><span class="op">(</span><span class="st">"~/Desktop/research/Kevin He/PRS/Rewrite_Lassosum/example/SAS1.GWAS"</span>,header <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">Tss</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   CHR     BP A1 A2 Sign    N      P</span></span>
<span><span class="co">## 1   1 753405  A  C    1 1760 0.3624</span></span>
<span><span class="co">## 2   1 754192  G  A    1 1760 0.3065</span></span>
<span><span class="co">## 3   1 757640  A  G    1 1760 0.4178</span></span>
<span><span class="co">## 4   1 758626  T  C    1 1760 0.5019</span></span>
<span><span class="co">## 5   1 769223  G  C   -1 1760 0.6513</span></span>
<span><span class="co">## 6   1 777122  T  A    1 1760 0.5741</span></span></code></pre>
<p>We use Tind to indicate the data type being provided to BRIGHTs, it should be either “GWAS” or “IProd”, corresponding to the GWAS summary statistics or the inner product mentioned above. In the provided example case we read in the IProd summary statistics from the target minority data and it contains 5 columns: the “CHR” column is the chromosome name must be from 1 to 22; the “BP” column is the corresponding SNPs position in base pair; “A1” column is the effect allele and “A2” column is the reference allele; the “IProd” column contains the marginal genotype-trait inner product; alternatively, we can also read in the GWAS summary statistics from the target minority data and it contains 7 columns: the “CHR” column is the chromosome name must be from 1 to 22; the “BP” column is the corresponding SNPs position in base pair; “A1” column is the effect allele and “A2” column is the reference allele; “Sign” is the marginal association direction for each SNPs (the sign of the beta coefficients); “N” column is the sample size used for each SNPs from GWAS study; “P” column is the p-value of the T test from GWAS.</p>
<p>Second, we read in the prior majority summary statistics into R. As discussed, there are three options of summary statistics to be used for minority populations, below we present the three options separately and note in real application only one of the data is required for each prior data. We note that more than 1 prior majority data can be incorporated in the BRIGHTs model.</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">### Read prior majority GWAS summary statistics file more than 1 prior majority data can be read in###</span></span>
<span></span>
<span><span class="va">Pind</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"GWAS"</span><span class="op">)</span></span>
<span><span class="va">Pss</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.table</a></span><span class="op">(</span><span class="st">"~/Desktop/research/Kevin He/PRS/Rewrite_Lassosum/example/EUR.GWAS"</span>,header <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">Pss</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   CHR     BP A1 A2 Sign     N       P</span></span>
<span><span class="co">## 1   1 753405  A  C    1 11514 0.07215</span></span>
<span><span class="co">## 2   1 754192  G  A    1 11514 0.10150</span></span>
<span><span class="co">## 3   1 757640  A  G    1 11514 0.10570</span></span>
<span><span class="co">## 4   1 758626  T  C    1 11514 0.09299</span></span>
<span><span class="co">## 5   1 769223  G  C   -1 11514 0.09536</span></span>
<span><span class="co">## 6   1 777122  T  A    1 11514 0.05061</span></span></code></pre>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">### Read prior majority marginal genotype-trait inner product more than 1 prior majority data can be read in###</span></span>
<span></span>
<span><span class="va">Pind</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"IProd"</span><span class="op">)</span></span>
<span><span class="va">Pss</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.table</a></span><span class="op">(</span><span class="st">"~/Desktop/research/Kevin He/PRS/Rewrite_Lassosum/example/EUR.IProd"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">Pss</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##    V1     V2 V3 V4                  V5</span></span>
<span><span class="co">## 1 CHR     BP A1 A2               IProd</span></span>
<span><span class="co">## 2   1 753405  A  C   0.016758471388529</span></span>
<span><span class="co">## 3   1 754192  G  A  0.0152624107131228</span></span>
<span><span class="co">## 4   1 757640  A  G  0.0150779150412605</span></span>
<span><span class="co">## 5   1 758626  T  C  0.0156557286728815</span></span>
<span><span class="co">## 6   1 769223  G  C -0.0155433917010181</span></span></code></pre>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">### Read prior majority GWAS summary statistics file, marginal genotype-trait inner product, or joint coefficient estimates, more than 1 prior majority data can be read in###</span></span>
<span></span>
<span><span class="va">Pind</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Coef"</span><span class="op">)</span></span>
<span><span class="va">Pss</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.table</a></span><span class="op">(</span><span class="st">"~/Desktop/research/Kevin He/PRS/Rewrite_Lassosum/example/EUR.Coef"</span>,header <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">Pss</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   CHR     BP A1 A2        Coef</span></span>
<span><span class="co">## 1   1 753405  A  C 0.000000000</span></span>
<span><span class="co">## 2   1 754192  G  A 0.000000000</span></span>
<span><span class="co">## 3   1 757640  A  G 0.000000000</span></span>
<span><span class="co">## 4   1 758626  T  C 0.000000000</span></span>
<span><span class="co">## 5   1 769223  G  C 0.000000000</span></span>
<span><span class="co">## 6   1 777122  T  A 0.001384477</span></span></code></pre>
<p>We use Pind to indicate the data type being provided to BRIGHTs, it should be either “GWAS”, “IProd”, or “Coef”, corresponding to the GWAS summary statistics, the inner product, or the joint coefficient estimates respectively. In the provided example case we read in the IProd summary statistics from the prior data and it contains 5 columns: the “CHR” column is the chromosome name must be from 1 to 22; the “BP” column is the corresponding SNPs position in base pair; “A1” column is the effect allele and “A2” column is the reference allele; the “IProd” column contains the marginal genotype-trait inner product; alternatively, we can also read in the GWAS summary statistics from the prior data and it contains 7 columns: the “CHR” column is the chromosome name must be from 1 to 22; the “BP” column is the corresponding SNPs position in base pair; “A1” column is the effect allele and “A2” column is the reference allele; “Sign” is the marginal association direction for each SNPs (the sign of the beta coefficients); “N” column is the sample size used for each SNPs from GWAS study; “P” column is the p-value of the T test from GWAS; In addition, we can also read in the joint coefficient estimates summary statistics from the prior majority data and it contains 5 columns: the “CHR” column is the chromosome name must be from 1 to 22; the “BP” column is the corresponding SNPs position in base pair; “A1” column is the effect allele and “A2” column is the reference allele; “Coef” column is the coefficient estimate from joint models.</p>
<p>BRIGHTs also need to account for Linkage Disequilibrium (LD) via a reference panel (1000 genome project as default). The reference panel is assumed to be in PLINK 1 <a href="https://www.cog-genomics.org/plink/1.9/input#bed" class="external-link">format</a>. For reading in the reference LD information, if <code>ref</code> names are provided as “EUR” (European ancestry), “AFR” (African ancestry), “EAS” (East Asian ancestry), “SAS” (South Asian ancestry) ,or “AMR” (America admixed ancestry), then the default 1000 genome project reference panels will be used; otherwise <code>ref</code> needs to be provided as a directory to the PLINK1 format files (.bim, .bed, .fam). If PLINK1 files are provided then the user also needs to provide the LDblocks to use for the block structures in calculating LD, it also should be provided as “EUR” (European ancestry), “AFR” (African ancestry), “EAS” (East Asian ancestry), “SAS” (South Asian ancestry) ,or “AMR” (America admixed ancestry).</p>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">### Specify the PLINK file stub of the reference panel or "EUR", "AFR", "EAS", "SAS" ,or "AMR" ###</span></span>
<span><span class="va">Tref</span> <span class="op">&lt;-</span> <span class="st">"~/Desktop/research/Kevin He/PRS/Rewrite_Lassosum/example/SAS1"</span></span>
<span><span class="va">Pref</span> <span class="op">&lt;-</span> <span class="st">"~/Desktop/research/Kevin He/PRS/Rewrite_Lassosum/example/EUR"</span></span>
<span></span>
<span><span class="co">### Read LD region file, only required if ref.bfile is provided as PLINK1 format ###</span></span>
<span><span class="va">LDblocks</span> <span class="op">&lt;-</span> <span class="st">"SAS"</span> <span class="co"># This will use LD regions as defined in Berisa and Pickrell (2015) for the South Asian population and the hg19 genome build.</span></span>
<span><span class="co"># Other alternatives available. Type ?BRIGHTs for more details. </span></span></code></pre></div>
<p>Reference: <a href="https://academic.oup.com/bioinformatics/article/32/2/283/1743626/Approximately-independent-linkage-disequilibrium" class="external-link">Berisa and Pickrell (2015)</a></p>
<p>Then, a preprocessing step is required to remove the SNPs that are not in the reference panel from all data, convert target data into marginal SNPs-trait inner product, convert prior data into joint coefficient estimates, and match the effect alleles between the reference panel and data.</p>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/PreprocessS.html">PreprocessS</a></span><span class="op">(</span><span class="va">Tss</span>, <span class="va">Tind</span>, <span class="va">Tref</span>, <span class="va">Pss</span>, <span class="va">Pind</span>, <span class="va">Pref</span>, <span class="va">LDblocks</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Using user specified LD</span></span>
<span><span class="co">## 1 source of prior information identified</span></span>
<span><span class="co">## 5000 SNPs passed filtering for target data</span></span>
<span><span class="co">## 5000 SNPs passed filtering for prior data 1</span></span></code></pre>
<p>Finally, BRIGHTs can be run by using standard pipeline with LASSO penalty on quantitative traits:</p>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/BRIGHTs.html">BRIGHTs</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">dat</span>, type.trait<span class="op">=</span><span class="st">"quantitative"</span>, penalty<span class="op">=</span><span class="st">"LASSO"</span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="model-validation-hyper-parameter-fine-tuning-and-visualization">Model validation, hyper-parameter fine-tuning and visualization<a class="anchor" aria-label="anchor" href="#model-validation-hyper-parameter-fine-tuning-and-visualization"></a>
</h3>
<p>For model validation, hyper-parameter fine tuning, or visualization options, please refer to the Quick Start section.</p>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Perform validation with individual-level validation data</span></span>
<span><span class="va">Val</span> <span class="op">&lt;-</span> <span class="fu">Valid.Ind</span><span class="op">(</span><span class="va">out</span>, <span class="va">Valipheno</span>, <span class="va">Valigeno</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Extracting number of samples and rownames from SAS2.fam...</span></span></code></pre>
<pre><code><span><span class="co">## Extracting number of variants and colnames from SAS2.bim...</span></span></code></pre>
<pre><code><span><span class="co">## [1] "Best eta based on R2 is 1.833"</span></span>
<span><span class="co">## [1] "Best lambda based on R2 is 0.056"</span></span>
<span><span class="co">## [1] "Best eta based on MSPE is 1.833"</span></span>
<span><span class="co">## [1] "Best lambda based on MSPE is 0.044"</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="model-testing-with-individual-level-testing-data">Model testing with individual-level testing data<a class="anchor" aria-label="anchor" href="#model-testing-with-individual-level-testing-data"></a>
</h3>
<p>Finally, the selected model can be tested on individual-level testing data, we first read in the individual-level testing data:</p>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Plot density plot</span></span>
<span><span class="co">#Density.plot(Val,Pct=0.9)</span></span></code></pre></div>
<p>The plots generated by “Density.plot” presents the distribution of continuous traits in test data stratified by a percentile cut-off (Pct) of the local, prior and BRIGHT PRS. These plots further visualize the discrimination power of each PRS model. In the plots, we compare the median distance between the upper and lower percentile PRS stratification of the observed outcome distribution, and show the distance in the title of the plots.</p>
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Plot ROC plot</span></span>
<span><span class="co">#ROC.plot(Val,Pct=0.9)</span></span></code></pre></div>
<p>The plots generated by “ROC.plot” presents the receiver operating characteristic (ROC) curve as well as the area under curve (AUC) measuring the prediction performance of local, prior, and BRIGHT PRS for a given threshold of the continuous traits (Pct).</p>
</div>
</div>
<div class="section level2">
<h2 id="brights-with-summary-level-data-type-traitqualitative-binary">BRIGHTs with summary-level data: type.trait=“qualitative” (Binary)<a class="anchor" aria-label="anchor" href="#brights-with-summary-level-data-type-traitqualitative-binary"></a>
</h2>
</div>
<div class="section level2">
<h2 id="brighti-with-individual-level-data-type-traitquantitative-continuous">BRIGHTi with individual-level data: type.trait=“quantitative” (Continuous)<a class="anchor" aria-label="anchor" href="#brighti-with-individual-level-data-type-traitquantitative-continuous"></a>
</h2>
</div>
<div class="section level2">
<h2 id="brighti-with-individual-level-data-type-traitqualitative-binary">BRIGHTi with individual-level data: type.trait=“qualitative” (Binary)<a class="anchor" aria-label="anchor" href="#brighti-with-individual-level-data-type-traitqualitative-binary"></a>
</h2>
</div>
<div class="section level2">
<h2 id="brighti-with-individual-level-data-type-traitcount-poisson">BRIGHTi with individual-level data: type.trait=“count” (Poisson)<a class="anchor" aria-label="anchor" href="#brighti-with-individual-level-data-type-traitcount-poisson"></a>
</h2>
</div>
<div class="section level2">
<h2 id="appendix-1">Appendix 1 <a class="anchor" aria-label="anchor" href="#appendix-1"></a>
</h2>
<p>To integrate summary-level or individual-level target minority data and summary-level prior majority data, while adjusting for the potential disparities between prior majority and target minority populations, BRIGHT solves the following penalized objective function, <span class="math display">\[\begin{align}
Q_{BRIGHT}(\boldsymbol\beta) =&amp; B_{\widetilde{\boldsymbol\Sigma}}(\boldsymbol{\hat\beta}||\boldsymbol\beta) + \eta B_{\widetilde{\boldsymbol\Sigma}}(\boldsymbol{\check\beta}||\boldsymbol\beta) + p_{\lambda}(\boldsymbol\beta),\label{eq: BRIGHT}
\end{align}\]</span> where <span class="math inline">\(\boldsymbol{\hat\beta}\)</span> and <span class="math inline">\(\boldsymbol{\check\beta}\)</span> are the estimated coefficients obtained from published studies based on target minority and prior majority populations, respectively; <span class="math inline">\(\widetilde{\boldsymbol\Sigma}\)</span> is the regularized block-structured LD estimation  from publicly available minority genotypes (e.g. 1000 genome project) or user specified Plink genotype files. <span class="math inline">\(B_{\widetilde{\boldsymbol\Sigma}}(\boldsymbol{\hat\beta}||\boldsymbol\beta)\)</span> (<span class="math inline">\(B_{\widetilde{\boldsymbol\Sigma}}(\boldsymbol{\check\beta}||\boldsymbol\beta)\)</span>) is the Bregman-divergence between <span class="math inline">\(\boldsymbol{\hat\beta}\)</span> (<span class="math inline">\(\boldsymbol{\check\beta}\)</span>) and <span class="math inline">\(\boldsymbol{\beta}\)</span>, measuring the discrepancy between the working model and the target minority model (prior majority model). In addition, <span class="math inline">\(\eta\)</span> is the weight balancing the importance of the minority data over the prior information to account for the population heterogeneity; when <span class="math inline">\(\eta=0\)</span>, BRIGHT will reduce to the penalized regression on the target data; when <span class="math inline">\(\eta\rightarrow\infty\)</span>, BRIGHTi will reduce to the penalized prior information. <span class="math inline">\(p_{\lambda}(\beta)\)</span> is a general penalty including (group) LASSO, (group) elastic net, (group) MCP, and (group) SCAD to achieve sparsity and fine mapping in the genotype effect size estimation.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Qinmengge Li.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
